<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修Python xlwt 写Excel相关操作记录' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>Python xlwt 写Excel相关操作记录</center></div><div class='banquan'>原文出处:本文由博客园博主piecesof提供。<br/>
原文连接:https://www.cnblogs.com/deliaries/p/11799951.html</div><br>
    <p>1、安装xlwt</p>
<div class="cnblogs_code">
<pre><code>pip install xlwt</pre>
</div>
<p>2、写Excel必要的几步</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">import</span><span style="color: #000000;"> xlwt<br />
book </span>= xlwt.Workbook()   　　　　　　<span style="color: #008000;">#</span><span style="color: #008000;">创建一个workbook，无编码设置编码<br /></span>book = xlwt.Workbook(encoding = <span style="color: #800000;">'</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">'</span>)    <span style="color: #008000;">#</span><span style="color: #008000;">创建一个workbook，并设置编码</span>
sheet = book.add_sheet(<span style="color: #800000;">'</span><span style="color: #800000;">testsheet</span><span style="color: #800000;">'</span>)     <span style="color: #008000;">#</span><span style="color: #008000;"> 创建一个sheet</span>
sheet.write(1,0, label=<span style="color: #800000;">'</span><span style="color: #800000;">test</span><span style="color: #800000;">'</span>,style)        <span style="color: #008000;">#</span><span style="color: #008000;"> 写入Excel操作，参数对应行、列、要写入的值，样式，样式可以不用带     </span>
book.save(<span style="color: #94558d;">self.file+"\</span><span style="color: #800000;">test.xls</span><span style="color: #800000;">"</span>)    <span style="color: #008000;">#</span><span style="color: #008000;"> 保存Excel</span></pre>
</div>
<p>&nbsp;运行后，会在file这个路径下生成一个&ldquo;test.xls&rdquo;的文件。</p>
<p>&nbsp;3、将时间写入到Excel单元格</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">import</span><span style="color: #000000;"> xlwt
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> datetime

book </span>=<span style="color: #000000;"> xlwt.Workbook()
sheet </span>= book.add_sheet(<span style="color: #800000;">'</span><span style="color: #800000;">timetest</span><span style="color: #800000;">'</span><span style="color: #000000;">)
style </span>=<span style="color: #000000;"> xlwt.XFStyle()
style.num_format_str </span>= <span style="color: #800000;">'</span><span style="color: #800000;">YYYY-MM-DD hh:mm:ss</span><span style="color: #800000;">'</span>  <span style="color: #008000;">#</span><span style="color: #008000;"> 格式由自己选择，可自由指定</span>
<span style="color: #000000;">sheet.write(0, 3, datetime.datetime.now(), style)
book.save(</span><span style="color: #800000;">'</span><span style="color: #800000;">timetest.xls</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>&nbsp;4、字体的操作</p>
<pre><code><span style="color: #000000; font-family: Microsoft YaHei;"> 0 = Black, 1 = White, 2 = Red, 3 = Green, 4 = Blue, 5 = Yellow, 6 = Magenta, 7 = Cyan, 16 = Maroon, 17 = Dark Green, 18 = Dark Blue, 19 = Dark Yellow, <br />（almost brown), 20 = Dark Magenta, 21 = Teal, 22 = Light Gray, 23 = Dark Gray</span></pre>
<div class="cnblogs_code">
<pre><code>    <span style="color: #0000ff;">import</span><span style="color: #000000;"> xlwt
    book </span>= xlwt.Workbook(encoding=<span style="color: #800000;">'</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    sheet </span>= book.add_sheet(<span style="color: #800000;">'</span><span style="color: #800000;">testsheet</span><span style="color: #800000;">'</span><span style="color: #000000;">)

    </span><span style="color: #008000;">#</span><span style="color: #008000;"> 设置字体</span>
    style =<span style="color: #000000;"> xlwt.XFStyle()
    font </span>=<span style="color: #000000;"> xlwt.Font()
    font.bold </span>= True    <span style="color: #008000;">#</span><span style="color: #008000;"> 字体加粗</span>
    font.name = <span style="color: #800000;">'</span><span style="color: #800000;">Times New Roman</span><span style="color: #800000;">'</span>   <span style="color: #008000;">#</span><span style="color: #008000;"> 选择字体</span>
    font.underline = True   <span style="color: #008000;">#</span><span style="color: #008000;"> 字体下划线</span>
    font.italic = True  <span style="color: #008000;">#</span><span style="color: #008000;"> 斜体</span>
    font.height = 300   <span style="color: #008000;">#</span><span style="color: #008000;"> 字体大小</span>
    font.colour_index = 3  <span style="color: #008000;">#</span><span style="color: #008000;"> 字体颜色</span><span style="color: #000000;">
    style.font </span>=<span style="color: #000000;"> font
    sheet.write(</span>1,1,<span style="color: #800000;">'</span><span style="color: #800000;">This is a testcase</span><span style="color: #800000;">'</span><span style="color: #000000;">)　　　　<span style="color: #008000;"># 不带样式写入</span>
    sheet.write(</span>2,1,<span style="color: #800000;">'</span><span style="color: #800000;">This is a testcase</span><span style="color: #800000;">'</span>,style)　　<span style="color: #008000;"># 带样式写入<br />　　 <span style="color: #000000;">book.save(</span>file + <span style="color: #008080; font-weight: bold;">'<span style="color: #000080; font-weight: bold;">\\<span style="color: #008080; font-weight: bold;">test_excel.xls'<span style="color: #000000;">)</span><br /></span></span></span><br /></span></pre>
</div>
<p><img src="./images/Python xlwt 写Excel相关操作记录0.png" alt="" /></p>
<p>也可以换种方式：使用xlwt.easyxf</p>
<div class="cnblogs_code">
<pre><code>    <span style="color: #0000ff;">import</span><span style="color: #000000;"> xlwt
    book </span>= xlwt.Workbook(encoding=<span style="color: #800000;">'</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    sheet </span>= book.add_sheet(<span style="color: #800000;">'</span><span style="color: #800000;">testsheet</span><span style="color: #800000;">'</span><span style="color: #000000;">)

    style </span>= xlwt.easyxf(<span style="color: #800000;">'</span><span style="color: #800000;">font: colour_index red, bold on</span><span style="color: #800000;">'</span><span style="color: #000000;">)

    </span><span style="color: #008000;">#</span><span style="color: #008000;"> style = xlwt.easyxf('font: height 300')</span>
    sheet.write(2,1,<span style="color: #800000;">'</span><span style="color: #800000;">This is a testcase</span><span style="color: #800000;">'</span><span style="color: #000000;">,style)
    book.save(file </span>+ <span style="color: #800000;">'</span><span style="color: #800000;">\\test_excel.xls</span><span style="color: #800000;">'</span>)</pre>
</div>
<p><img src="./images/Python xlwt 写Excel相关操作记录1.png" alt="" /></p>
<p>&nbsp; 5、设置单元格的宽、高</p>
<p><span style="font-family: Microsoft YaHei; font-size: 14px; line-height: 25px;">行宽设置：</span></p>
<p><span style="font-family: Microsoft YaHei; font-size: 14px; line-height: 25px;">xlwt中列宽的值表示方法：默认字体0的1/256为衡量单位。<br style="font-family: Simsun; font-size: 14px; line-height: 25px;" /><span style="font-size: 14px; line-height: 25px;">xlwt创建时使用的默认宽度为2960，既11个字符0的宽度<br style="font-family: Simsun; font-size: 14px; line-height: 25px;" /><span style="font-size: 14px; line-height: 25px;">我们在设置列宽时可以用此方法：<span style="font-size: 14px; line-height: 25px;">width = 256 * 20 &nbsp; &nbsp;256为衡量单位，20表示20个字符宽度</span></span></span></span></p>
<div class="cnblogs_code">
<pre><code>    <span style="color: #0000ff;">import</span><span style="color: #000000;"> xlwt
    sheet </span>= book.add_sheet(<span style="color: #800000;">'</span><span style="color: #800000;">testsheet</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    sheet.write(</span>1,1,<span style="color: #800000;">'</span><span style="color: #800000;">This is a testcase</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    sheet.col(0).width </span>= 5120    <span style="color: #008000;">#</span><span style="color: #008000;"> 设置单元格宽度</span>
    book.save(file + <span style="color: #800000;">'</span><span style="color: #800000;">\\test_excel.xls</span><span style="color: #800000;">'</span>)</pre>
</div>
<p><img src="./images/Python xlwt 写Excel相关操作记录2.png" alt="" /></p>
<p>行高设置：</p>
<p><span style="font-family: Microsoft YaHei; font-size: 14px; line-height: 25px;">行高可以不设定，会根据自己设置字体的大小自动适应行高</span></p>
<p><span style="font-family: Microsoft YaHei; font-size: 14px; line-height: 25px;">6、为单元格设置背景色</span></p>
<pre><code><span style="font-family: Microsoft YaHei;"><span style="color: #000000;"> may be :<code><span class="hljs-comment"><span class="hljs-comment">8 through 63</span></span></code>. 0 = Black, 1 = White, 2 = Red, 3 = Green, 4 = Blue, 5 = Yellow, 6 = Magenta, 7 = Cyan, 16 = Maroon, 17 = Dark Green, 18 = Dark Blue, 19 = Dark Yellow, <br />（almost brown), 20 = Dark Magenta, 21 = Teal, 22 = Light Gray, 23 = Dark Gray</span> or</span> </pre>
<div class="cnblogs_code">
<pre><code>    <span style="color: #0000ff;">import</span><span style="color: #000000;"> xlwt
    book </span>= xlwt.Workbook(encoding=<span style="color: #800000;">'</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    sheet </span>= book.add_sheet(<span style="color: #800000;">'</span><span style="color: #800000;">testsheet</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    style </span>=<span style="color: #000000;"> xlwt.XFStyle()
    sheet.col(</span>1).width = 5120<span style="color: #000000;">
    bg </span>=<span style="color: #000000;"> xlwt.Pattern()
    bg.pattern </span>= bg.SOLID_PATTERN   <span style="color: #008000;">#</span><span style="color: #008000;"> NO_PATTERN, SOLID_PATTERN, or 0x00 through 0x12</span>
    bg.pattern_fore_colour = 3<span style="color: #000000;">
    style.pattern </span>=<span style="color: #000000;"> bg
    sheet.write(</span>2,1,<span style="color: #800000;">'</span><span style="color: #800000;">This is a testcase</span><span style="color: #800000;">'</span><span style="color: #000000;">,style)
    book.save(file </span>+ <span style="color: #800000;">'</span><span style="color: #800000;">\\test_excel.xls</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>&nbsp;<img src="./images/Python xlwt 写Excel相关操作记录3.png" alt="" /></p>
<p>&nbsp;设置背景色也可以换一种方式：使用xlwt.easyxf</p>
<div class="cnblogs_code">
<pre><code>    <span style="color: #0000ff;">import</span><span style="color: #000000;"> xlwt
    book </span>= xlwt.Workbook(encoding=<span style="color: #800000;">'</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    sheet </span>= book.add_sheet(<span style="color: #800000;">'</span><span style="color: #800000;">testsheet</span><span style="color: #800000;">'</span><span style="color: #000000;">)

    style </span>= xlwt.easyxf(<span style="color: #800000;">'</span><span style="color: #800000;">pattern: pattern solid, fore_colour red</span><span style="color: #800000;">'</span><span style="color: #000000;">)

    sheet.write(</span>2,1,<span style="color: #800000;">'</span><span style="color: #800000;">This is a testcase</span><span style="color: #800000;">'</span><span style="color: #000000;">,style)
    book.save(file </span>+ <span style="color: #800000;">'</span><span style="color: #800000;">\\test_excel.xls</span><span style="color: #800000;">'</span>)</pre>
</div>
<p><img src="./images/Python xlwt 写Excel相关操作记录4.png" alt="" /></p>
<p><span style="font-family: Microsoft YaHei;">&nbsp;7<span style="font-size: 14px; line-height: 25px;">、为单元格添加边框</span></span></p>
<p>&nbsp;<span style="color: #000000;">borders</span>的分类大致分为：<code><span class="hljs-comment"><span class="hljs-comment">NO_LINE, THIN, MEDIUM, DASHED, DOTTED, THICK, DOUBLE, HAIR, MEDIUM_DASHED, THIN_DASH_DOTTED, MEDIUM_DASH_DOTTED, THIN_DASH_DOT_DOTTED, MEDIUM_DASH_DOT_DOTTED, SLANTED_MEDIUM_DASH_DOTTED, or 0x00 through 0x0D.</span></span></code></p>
<div class="cnblogs_code">
<pre><code>    <span style="color: #0000ff;">import</span><span style="color: #000000;"> xlwt
    book </span>= xlwt.Workbook(encoding=<span style="color: #800000;">'</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    sheet </span>= book.add_sheet(<span style="color: #800000;">'</span><span style="color: #800000;">testsheet</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    style </span>=<span style="color: #000000;"> xlwt.XFStyle()
    sheet.col(</span>1).width = 5120<span style="color: #000000;">
    borders </span>=<span style="color: #000000;"> xlwt.Borders()
    borders.left </span>=<span style="color: #000000;"> borders.DASHED
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> DASHED虚线</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> NO_LINE没有</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> THIN实线</span>
    borders.right =<span style="color: #000000;"> borders.THIN
    borders.top </span>=<span style="color: #000000;"> borders.NO_LINE
    borders.bottom </span>=<span style="color: #000000;"> borders.DOUBLE
    borders.left_colour </span>= 6<span style="color: #000000;">
    borders.right_colour </span>= 4<span style="color: #000000;">
    borders.top_colour </span>= 4<span style="color: #000000;">
    borders.bottom_colour </span>= 3<span style="color: #000000;">
    style.borders </span>=<span style="color: #000000;"> borders
    sheet.write(</span>2,1,<span style="color: #800000;">'</span><span style="color: #800000;">This is a testcase</span><span style="color: #800000;">'</span><span style="color: #000000;">,style)
    book.save(file </span>+ <span style="color: #800000;">'</span><span style="color: #800000;">\\test_excel.xls</span><span style="color: #800000;">'</span>)</pre>
</div>
<p><img src="./images/Python xlwt 写Excel相关操作记录5.png" alt="" /></p>
<p>&nbsp;8、设置单元格里面内容的对其方式</p>
<p>&nbsp;单元格对其方式有两种：水平对齐（hoze）和垂直对齐（vert）</p>
<p>水平对齐包含：<code><span class="hljs-comment"><span class="hljs-comment"> HORZ_GENERAL, HORZ_LEFT, HORZ_CENTER, HORZ_RIGHT, HORZ_FILLED, HORZ_JUSTIFIED, HORZ_CENTER_ACROSS_SEL, HORZ_DISTRIBUTED</span></span></code></p>
<p>垂直对齐包含：<code><span class="hljs-comment"><span class="hljs-comment">VERT_TOP, VERT_CENTER, VERT_BOTTOM, VERT_JUSTIFIED, VERT_DISTRIBUTED</span></span></code></p>
<div class="cnblogs_code">
<pre><code>    <span style="color: #0000ff;">import</span><span style="color: #000000;"> xlwt
    book </span>= xlwt.Workbook(encoding=<span style="color: #800000;">'</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    sheet </span>= book.add_sheet(<span style="color: #800000;">'</span><span style="color: #800000;">testsheet</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    aligment </span>=<span style="color: #000000;"> xlwt.Alignment()
    aligment.horz </span>= aligment.HORZ_CENTER    <span style="color: #008000;">#</span><span style="color: #008000;"> 水平对齐方式</span>
    aligment.vert = aligment.VERT_BOTTOM    <span style="color: #008000;">#</span><span style="color: #008000;"> 垂直对其方式</span>
    style.alignment =<span style="color: #000000;"> aligment
    sheet.write(</span>2,1,<span style="color: #800000;">'</span><span style="color: #800000;">This is a testcase</span><span style="color: #800000;">'</span><span style="color: #000000;">,style)
    book.save(file </span>+ <span style="color: #800000;">'</span><span style="color: #800000;">\\test_excel.xls</span><span style="color: #800000;">'</span>)</pre>
</div>
<p><img src="./images/Python xlwt 写Excel相关操作记录6.png" alt="" /></p>
<p>9、合并单元格行、列</p>
<p>合并单元格是在写入的时候合并，使用write_merge,相对于write来说里面增加了两个参数，即合并的行和列。write_merge参数的前两个代表要合并的行，三到四位参数代表的是要合并的列。</p>
<div class="cnblogs_code">
<pre><code>    <span style="color: #0000ff;">import</span><span style="color: #000000;"> xlwt
    book </span>= xlwt.Workbook(encoding=<span style="color: #800000;">'</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    sheet </span>= book.add_sheet(<span style="color: #800000;">'</span><span style="color: #800000;">testsheet</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    sheet.write_merge(</span>1,3,1,1,<span style="color: #800000;">'</span><span style="color: #800000;">This is a testcase</span><span style="color: #800000;">'</span>)   <span style="color: #008000;">#</span><span style="color: #008000;"> 合并1-3行的1-1列，前两个参数代表行，后两个参数代表列</span>
    book.save(file + <span style="color: #800000;">'</span><span style="color: #800000;">\\test_excel.xls</span><span style="color: #800000;">'</span>)</pre>
</div>
<p><img src="./images/Python xlwt 写Excel相关操作记录7.png" alt="" /></p>
<p>&nbsp;</p>
<p>10、向单元格添加公式</p>
<p>向单元格中写公式时，通过xlwt.Formula添加公式</p>
<div class="cnblogs_code">
<pre><code>    <span style="color: #0000ff;">import</span><span style="color: #000000;"> xlwt
    book </span>= xlwt.Workbook(encoding=<span style="color: #800000;">'</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    sheet </span>= book.add_sheet(<span style="color: #800000;">'</span><span style="color: #800000;">testsheet</span><span style="color: #800000;">'</span>)<br />    sheet.write(0,0,5<span style="color: #000000;">)
    sheet.write(0,</span>1,6<span style="color: #000000;">)
    sheet.write(</span>1,0,xlwt.Formula(<span style="color: #800000;">'</span><span style="color: #800000;">A1*B1</span><span style="color: #800000;">'</span>))      <span style="color: #008000;">#</span><span style="color: #008000;"> A1[5]*B1[6]=30</span>
    sheet.write(2,0,xlwt.Formula(<span style="color: #800000;">'</span><span style="color: #800000;">SUM(A1:A2)</span><span style="color: #800000;">'</span>))     <span style="color: #008000;">#</span><span style="color: #008000;"> A1[5]+A2[30]=35</span>
    book.save(file + <span style="color: #800000;">'</span><span style="color: #800000;">\\test_excel.xls</span><span style="color: #800000;">'</span></pre>
</div>
<p>&nbsp;11、向单元格添加超链接</p>
<div class="cnblogs_code">
<pre><code>    <span style="color: #0000ff;">import</span><span style="color: #000000;"> xlwt
    book </span>= xlwt.Workbook(encoding=<span style="color: #800000;">'</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    sheet </span>= book.add_sheet(<span style="color: #800000;">'</span><span style="color: #800000;">testsheet</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    sheet.write(0,0,xlwt.Formula(</span><span style="color: #800000;">'</span><span style="color: #800000;">HYPERLINK("https://www.baidu.com";"百度")</span><span style="color: #800000;">'</span>))    <span style="color: #008000;">#</span><span style="color: #008000;"> 向单元格写入文字：百度，并加上链接：https://www.baidu.com</span></pre>
</div>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>