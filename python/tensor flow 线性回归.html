<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修tensor flow 线性回归' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>tensor flow 线性回归</center></div><div class='banquan'>原文出处:本文由博客园博主拓子提供。<br/>
原文连接:https://www.cnblogs.com/tuozizhang/p/11623840.html</div><br>
    <p># -*- coding: utf-8 -*-<br />"""<br />Spyder Editor</p>
<p>This is a temporary script file.<br />tensor flow 之线性回归模式<br />2019-oct-5<br />"""</p>
<p><img src="./images/tensor flow 线性回归0.png" alt="" width="378" height="252" /></p>
<p>import tensorflow as tf<br />import numpy as np<br />import matplotlib.pyplot as plt</p>
<p>SIZE=100<br />np.random.seed(100)#np随机种子<br />tf.set_random_seed(100)#tf随机种子<br />#1、构建数据<br />x=np.linspace(0,2,SIZE) #等差数列<br />noise_x=np.random.normal(loc=0.0,scale=1.0,size=SIZE) #&lsquo;随机正太分布  增加噪音<br />x=x+noise_x  </p>
<p>y=8*x+8 #用于填充Y数组<br />noise_y=np.random.normal(loc=0.0,scale=1.1,size=SIZE)<br />y=y+noise_y</p>
<p>#2、设置为矩阵的模型<br />x.shape=(-1,1)<br />y.shape=(-1,1)</p>
<p><br />#3、构建一个模型 y=w*x+b 设置tf变量 用于训炼<br />w=tf.Variable(initial_value=tf.random_uniform(shape=[1],minval=-1.0,maxval=1.0,name='w'))<br />b=tf.Variable(initial_value=tf.zeros(shape=[1],name='b'))</p>
<p>#4、得到预测值 <br />y_hat=w*x+b</p>
<p>#5、构建损失函数 loss<br />loss=tf.reduce_mean(tf.square(y_hat-y),name='loss') #损失函数 loss=聚合平均值（差的平方）</p>
<p>#6、梯度下降 优化损失函数 ，让其最小<br />optiomizer=tf.train.GradientDescentOptimizer(learning_rate=0.05)#初始化变量 及学习<br />train=optiomizer.minimize(loss=loss) #求最小损失函数 loss</p>
<p>&nbsp;</p>
<p>#执行训练<br />with tf.Session() as sess:<br />    sess.run(tf.global_variables_initializer())<br />    run_w,run_b,run_loss=sess.run([w,b,loss])<br />    print('w={},b={},loss={}'.format(run_w,run_b,run_loss))</p>
<p><br />    for i in range(100):#训练100次<br />        sess.run(train)<br />        run_w,run_b,run_loss=sess.run([w,b,loss])#取w,b,loss这三个东东的值 并打印展示<br />        print('w={},b={},loss={}'.format(run_w,run_b,run_loss))<br />        <br />#画表展示<br />        #画线<br />x_hat=np.linspace(x.min(),x.max())<br />print("x_hat={}".format(x_hat))<br />y_hat2=run_w*x_hat+run_b<br />plt.plot(x_hat,y_hat2)<br /> #画线<br /> #画点<br />plt.plot(x,y,'go') #go rs ro <br />#画点<br />plt.show()#显示</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>