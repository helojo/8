<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修默认浏览器争霸传奇' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>默认浏览器争霸传奇</center></div><div class='banquan'>原文出处:本文由博客园博主轩辕之风提供。<br/>
原文连接:https://www.cnblogs.com/xuanyuan/p/12053056.html</div><br>
    <p>噼里啪啦鞭炮响，我们公司开张了！</p>
<p>今天是我们千度浏览器公司开业第一天，公司主营业务是网页浏览，我们来到这个陌生的Windows帝国创业，虽然这里已经有IE浏览器公司发展多年，但因为他们是国有企业，不思进取，办事效率低，所以我们有信心，期待着为人类提供更好的上网体验。</p>
<p><img src="./images/默认浏览器争霸传奇0.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>几天过去了，一笔上网业务都没收到，市场部老大开始急了，指定了我和军军去调研下怎么回事。经过一番研究，原来我们不是这台电脑的默认浏览器，用户点击链接的时候，会使用默认的浏览器打开，默认浏览器是361浏览器公司，我们自然是没有业务了。</p>
<p>&nbsp;</p>
<p>汇报完调查结果，老大发了话：不管你们用什么办法，把我们变成默认浏览器！</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3 style="text-align: center;"><span style="color: #ff6600;"><strong>&lt;-----------------------第一战：</strong><strong>拿下注册表<strong>-----------------------&gt;</strong></strong></span></h3>
<p>工作不敢怠慢，又经过一番研究，原来系统的默认浏览器是登记在一个叫注册表的帝国核心数据仓库，打开链接的时候，就会去这里查询谁是默认浏览器。</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="./images/默认浏览器争霸传奇1.png" alt="" width="178" height="178" /></p>
<p style="text-align: center;">&nbsp;注册表：Windows帝国核心机要配置数据库</p>
<p>&nbsp;</p>
<p>原理搞清楚了，问题就好办了，我赶紧调用注册表的接口函数，把我们千度浏览器设置成为系统默认浏览器。这不写不知道，一写吓一跳，居然失败了，告诉我拒绝访问，没有权限！</p>
<p>&nbsp;</p>
<p>我意识到问题可能没有我想的那么简单，赶紧向军军求助。军军：看来361浏览器下面有人！我：下面有人？我只听过上面有人，下面有人什么意思？军军：你不知道，这个世界是分高低贵贱的，我们这些普通线程一般情况下都是在用户态工作，权限极小，而那些位高权重的线程都是执行在内核态的，他们可以干的事情比我们多得多，帝国政府工作线程基本都是工作在内核态的。因为他们工作在底层，所以称为下面。<br /><img style="display: block; margin-left: auto; margin-right: auto;" src="./images/默认浏览器争霸传奇2.png" alt="" width="326" height="178" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><br />我：那361浏览器下面的人哪来的？军军：帝国开了一个口子，允许加载驱动进入内核态，361浏览器公司多半是通过这种方式进去的，进去之后把注册表给守着，不允许我们在上面修改默认浏览器。我：那咱们也用驱动进去，进入内核态跟它竞争。军军：可以试试。</p>
<p>&nbsp;</p>
<p>
说干就干，我们弄了个驱动程序，顺利的进入了帝国的内核空间，我还是第一次到这里来，这里的世界果然大不一样，不过这次任务紧急，没时间慢慢欣赏了。经过排查，361公司做了重重保护，不仅对内核函数执行了HOOK，还设置了注册表操作回调通知，相当于给修改注册表的路上装了监控摄像头，我们的一举一动都能被对方知道。</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="./images/默认浏览器争霸传奇3.png" alt="" width="279" height="181" /></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;</p>
<p>
军军：看来361公司对默认浏览器的注册表看护森严，轻易是动不了的。</p>
<p>我：那难道没办法了吗？</p>
<p>军军：也不尽然，大路被361公司看得死死的，我们走小路，绕过他的监控，或许可以一试。</p>
<p>按照军军的思路，我们抄了一条小路，绕过那些敏感的函数，直接调用底层的注册表写入函数，这一次总算写入成功！<br />回到公司，终于有业务找上门来，看着业务部门忙碌的身影，我们非常开心。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3 style="text-align: center;"><span style="color: #ff6600;"><strong><strong>&lt;-----------------------</strong>第二战：瞒天过海<strong><strong>-----------------------&gt;</strong></strong></strong></span></h3>
<p>然而好景不长，仅仅过了几天，生意又开始惨淡起来，隔壁361公司生意反倒好了起来。难道默认浏览器又被361公司改了回去？</p>
<p>&nbsp;</p>
<p>
我赶紧去看了一下注册表，奇怪了，里面写的还是我们千度浏览器啊，怎么就没生意了呢？这一下难倒我们了，问题到底出在哪里？一连好几天都没有思路。</p>
<p>&nbsp;</p>
<p>
无奈之下，我决定再去内核态一探究竟。没过多久，果然有人来查注册表了，我在远处拿着望远镜看着，361公司的人检查了参数，就直接放他过去了，原来这人来查的不是默认浏览器。一直等了好久，终于有人来查默认浏览器了，这361公司居然直接给了他结果，就让他回去了，都没有真正去注册表去查！</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="./images/默认浏览器争霸传奇4.png" alt="" width="162" height="148" /></p>
<p>气死我了！原来给了别人假的结果！我把我看到的一切都告诉了军军。</p>
<p>&nbsp;</p>
<p>
我和军军开始关起门来，研究对策。然而还没等我们研究出个结果，市场部老大又过来了。老大：你们先别研究了，361公司也没生意了，来了个QB浏览器，生意都去他们那里了，赶紧去看看。竟有此事！我们放下手中的工作，赶紧去瞧一瞧。<br /><br /><br /></p>
<h3 style="text-align: center;"><span style="color: #ff6600;"><strong><strong>&lt;-----------------------</strong>第三战：半路截胡<strong><strong>-----------------------&gt;</strong></strong></strong></span></h3>
<p>QB浏览器果然热闹非凡，来往办理业务的络绎不绝。他们是怎么抢了361公司生意的？我和军军都很诧异。</p>
<p>&nbsp;</p>
<p>
我再一次来到内核空间，守着注册表查询的地方，想看看发生了什么。然而一切都没有变，361公司仍然把守着关键位置。不一样的是等了大半天一个来查默认浏览器的人都没有。第二天，第三天，依旧如此，但是QB浏览器的生意倒是从未中断，我开始意识到不对劲。</p>
<p>&nbsp;</p>
<p>
当天晚上，我趁人不注意，通过远程线程注入的方式，乔装打扮溜到了Outlook邮箱公司，Outlook曾经是我们的大客户，但最近都不来照顾我们家生意了。我在Outlook公司的收件箱仓库翻了半天，终于找到一封带有链接的邮件，环顾四周见没人发现我，于是冒充Outlook公司的员工点开了一个链接，打算看下这笔业务怎么就跑到了QB浏览器公司。</p>
<p>&nbsp;</p>
<p>
接下来的事情让我大吃一惊：点击链接后，一条JMP指令居然让我跳到了数字签名为QB集团的一个模块中，而这里根本没让我查注册表，直接就给我QB浏览器的路径，让我去找他打开链接！</p>
<p><img style="display: block; margin-left: auto; margin-right: auto;" src="./images/默认浏览器争霸传奇5.png" alt="" width="159" height="146" /></p>
<p>&nbsp;</p>
<p>
真相总算大白，原来溜入Outlook公司的不止我一个，QB公司的人早就溜进来了，还安装了HOOK，欺骗所有人让他们都去自己那里办业务！回到公司，把我的经历告诉了市场部老大。老大大怒：这些公司也太没下线了，为了钱什么都能做出来。几秒种后，老大又说：我们得给他们一些教训，你们赶紧琢磨琢磨如何抢回来。</p>
<p>&nbsp;&nbsp;</p>
<p>&nbsp;</p>
<h3 style="text-align: center;"><span style="color: #ff6600;"><strong><strong>&lt;-----------------------</strong>终局之战：狸猫换太子<strong><strong>-----------------------&gt;</strong></strong></strong></span></h3>
<p>
不过我们终究还是嫩了一些，过了一晚上，第二天帝国又来了一家猎狗浏览器公司开业，网页浏览的生意一下又被他们抢了过去。<br />不得已，我只得故技重施，再次潜入Outlook公司，看看这猎狗浏览器又是如何抢到的客户。再次点击链接，按照熟悉的路线，拿到的还是QB浏览器公司的地址，我也顺利的调用CreateProcess函数把QB浏览器给启动了。然而等我回到公司，竟然神奇的发现，QB浏览器并没有启动，启动的竟然是猎狗浏览器，明明是我亲自打开的QB浏览器怎么就变成了猎狗浏览器？我有点怀疑自己眼睛是不是看错了。</p>
<p>&nbsp;</p>
<p>
我打算再来一次，这一次，我让军军溜入Outlook公司执行我开始的操作，而我去到内核态，看着进程启动的地方，看看哪个环节出了问题。收到军军的信号后，QB浏览器进程果然开始创建，接下来一幕让我惊掉了下巴：猎狗浏览器也在内核态安插了驱动，他们竟然把QB浏览器的执行文件exe换成了猎狗浏览器的！好一招狸猫换太子！</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h3 style="text-align: center;"><span style="color: #ff6600;"><strong><strong>&lt;-----------------------</strong>再见：浏览器江湖<strong><strong>-----------------------&gt;</strong></strong></strong></span></h3>
<p>
回到公司已是深夜，打算第二天再汇报领导。</p>
<p>
第二天，还没等到汇报工作，领导先召集我们开会：非常遗憾的告诉大家一个消息，由于公司的业绩持续下滑，千度集团决定砍掉这块业务，千度浏览器即将成为历史，大家准备好工作交接吧。消息来得突然，不过我也厌倦了这样的争斗，不做也好。</p>
<p>&nbsp;</p>
<p>
然而，默认浏览器的战争，还在继续&middot;&middot;&middot;&middot;&middot;&middot;</p>
<p>&nbsp;</p>
<p>未完待续&middot;&middot;&middot;&middot;&middot;&middot;&middot;</p>
<p>&nbsp;</p>
<fieldset><legend><strong>彩蛋</strong></legend>361浏览器公司眼看自己的市场被抢，情急之下致电361集团总部。总部很快派出了361杀毒和361安全卫士公司入驻，为361浏览器撑撑场子。而另一边，QB浏览器公司和猎狗浏览器公司同样不甘示弱，QB集团也派出了QB电脑管家，猎狗集团派出了猎狗毒霸，一场安全软件公司的战争一触即发&middot;&middot;&middot;
<p>&nbsp;</p>



欲知后事如何，请关注后续精彩：<strong>《远去的传说：</strong><strong>安全软件群雄混战史</strong><strong>》</strong></fieldset>
<p>&nbsp;</p>
<p><strong>精彩回顾</strong>：</p>
<p><a href="http://mp.weixin.qq.com/s?__biz=MzAwMjc3NDQ1Mw==&amp;mid=2247483721&amp;idx=1&amp;sn=fa200eb8ecaa7ad49373cce1690c27f5&amp;chksm=9ac40593adb38c85c9937de34fc34446f57fffc7885d4b26f6070083c688e9f38bc0a23349e5&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2">我是一个explorer的线程</a></p>
<p><a href="http://mp.weixin.qq.com/s?__biz=MzAwMjc3NDQ1Mw==&amp;mid=2247483734&amp;idx=1&amp;sn=1b2bd2a4338135c1a69986dcbb0afce8&amp;chksm=9ac4058cadb38c9ac785e47a1b46d70739fa9007b418091a32506ed452f82e82ed9b82225eda&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2">我是一个杀毒软件线程</a></p>
<p><a href="http://mp.weixin.qq.com/s?__biz=MzAwMjc3NDQ1Mw==&amp;mid=2247483748&amp;idx=1&amp;sn=679d9b76361a4fd08696a3783f54c110&amp;chksm=9ac405beadb38ca8bc0dc153ce3f92e92ae5759ec4bdbc1ec37afb25d0d60c5ba3477c37b851&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2">我是一个IE浏览器线程</a></p>
<p><a href="http://mp.weixin.qq.com/s?__biz=MzAwMjc3NDQ1Mw==&amp;mid=2247483775&amp;idx=1&amp;sn=694b8c8c4e6acf137c59909878c32eac&amp;chksm=9ac405a5adb38cb37887bda342f17061522821bf1afdddf082e0d37db17d78fdd411b5a7731d&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2">比特宇宙－TCP/IP的诞生</a></p>
<p><a href="http://mp.weixin.qq.com/s?__biz=MzAwMjc3NDQ1Mw==&amp;mid=2247483792&amp;idx=1&amp;sn=3377e7ac7f1f935aa4a306619cb7a5cb&amp;chksm=9ac4054aadb38c5c03201f27cba9b5953e1b8b06241bc3b2d4c77e8a7d2d47f2274c7ee6b707&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2">产品vs程序员：你知道www是怎么来的吗？</a></p>
<p><a href="http://mp.weixin.qq.com/s?__biz=MzAwMjc3NDQ1Mw==&amp;mid=2247483806&amp;idx=1&amp;sn=32adfe25c549c0c7b023429c5f2aab50&amp;chksm=9ac40544adb38c52349cc6927a28ac7b26c8434d96ee4e1117d5116deafa487c17312e8a1556&amp;scene=21#wechat_redirect" target="_blank" data-itemshowtype="0" data-linktype="2">我是一个流氓软件线程</a></p>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>