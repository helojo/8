<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修python--shutil模块' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>python--shutil模块</center></div><div class='banquan'>原文出处:本文由博客园博主梦想一步登天提供。<br/>
原文连接:https://www.cnblogs.com/june-L/p/11651303.html</div><br>
    <p>一、Python--shutil模块介绍：<br />高级的 文件、文件夹、压缩包 处理模块，导入import shutil</p>
<p>二、基本操作</p>
<p>2.1、shutil.copyfileobj(fsrc, fdst[, length])<br />将文件内容拷贝到另一个文件中</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">import</span><span style="color: #000000;"> shutil
shutil.copyfileobj(open(</span><span style="color: #800000;">'</span><span style="color: #800000;">old.xml</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">r</span><span style="color: #800000;">'</span>), open(<span style="color: #800000;">'</span><span style="color: #800000;">new.xml</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">w</span><span style="color: #800000;">'</span>))</pre>
</div>
<p>2.2、shutil.copyfile(src, dst)<br />拷贝文件</p>
<div class="cnblogs_code">
<pre><code>shutil.copyfile(<span style="color: #800000;">'</span><span style="color: #800000;">f1.log</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">f2.log</span><span style="color: #800000;">'</span>)<span style="color: #008000;">#</span><span style="color: #008000;">目标文件无需存在</span></pre>
</div>
<p>&nbsp;</p>
<p>2.3、shutil.copymode(src, dst)<br />仅拷贝权限。内容、组、用户均不变</p>
<div class="cnblogs_code">
<pre><code>shutil.copymode(<span style="color: #800000;">'</span><span style="color: #800000;">f1.log</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">f2.log</span><span style="color: #800000;">'</span>)<span style="color: #008000;">#</span><span style="color: #008000;">目标文件必须存在</span></pre>
</div>
<p>&nbsp;</p>
<p>2.4、shutil.copystat(src, dst)<br />仅拷贝状态的信息，包括：mode bits, atime, mtime, flags</p>
<div class="cnblogs_code">
<pre><code>shutil.copystat(<span style="color: #800000;">'</span><span style="color: #800000;">f1.log</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">f2.log</span><span style="color: #800000;">'</span>)<span style="color: #008000;">#</span><span style="color: #008000;">目标文件必须存在</span></pre>
</div>
<p>&nbsp;</p>
<p>2.5、shutil.copy(src, dst)<br />拷贝文件和权限</p>
<div class="cnblogs_code">
<pre><code>shutil.copy(<span style="color: #800000;">'</span><span style="color: #800000;">f1.log</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">f2.log</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>&nbsp;</p>
<p>2.6、shutil.copytree(src, dst, symlinks=False, ignore=None)<br />递归的去拷贝文件夹</p>
<div class="cnblogs_code">
<pre><code>shutil.copytree(<span style="color: #800000;">'</span><span style="color: #800000;">folder1</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">folder2</span><span style="color: #800000;">'</span>, ignore=shutil.ignore_patterns(<span style="color: #800000;">'</span><span style="color: #800000;">*.pyc</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">tmp*</span><span style="color: #800000;">'</span><span style="color: #000000;">))
</span><span style="color: #008000;">#</span><span style="color: #008000;">目标目录不能存在，注意对folder2目录父级目录要有可写权限，ignore的意思是排除</span></pre>
</div>
<p>&nbsp;</p>
<p>2.7、shutil.rmtree(path[, ignore_errors[, onerror]])<br />递归的去删除文件</p>
<div class="cnblogs_code">
<pre><code>shutil.rmtree(<span style="color: #800000;">'</span><span style="color: #800000;">folder1</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>&nbsp;</p>
<p>2.8、shutil.move(src, dst)<br />递归的去移动文件，它类似mv命令，其实就是重命名。</p>
<div class="cnblogs_code">
<pre><code>shutil.move(<span style="color: #800000;">'</span><span style="color: #800000;">folder1</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">folder3</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>&nbsp;</p>
<p>2.8、shutil.make_archive(base_name, format,...)<br />创建压缩包并返回文件路径，例如：zip、tar<br />创建压缩包并返回文件路径，例如：zip、tar<br />base_name： 压缩包的文件名，也可以是压缩包的路径。只是文件名时，则保存至当前目录，否则保存至指定路径，<br />如 data_bak   =&gt;保存至当前路径<br />如：/tmp/data_bak =&gt;保存至/tmp/<br />format：	压缩包种类，&ldquo;zip&rdquo;, &ldquo;tar&rdquo;, &ldquo;bztar&rdquo;，&ldquo;gztar&rdquo;<br />root_dir：	要压缩的文件夹路径（默认当前目录）<br />owner：	用户，默认当前用户<br />group：	组，默认当前组<br />logger：	用于记录日志，通常是logging.Logger对象</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;">将 /data 下的文件打包放置当前程序目录</span>
ret = shutil.make_archive(<span style="color: #800000;">"</span><span style="color: #800000;">data_bak</span><span style="color: #800000;">"</span>, <span style="color: #800000;">'</span><span style="color: #800000;">gztar</span><span style="color: #800000;">'</span>, root_dir=<span style="color: #800000;">'</span><span style="color: #800000;">/data</span><span style="color: #800000;">'</span><span style="color: #000000;">）
</span><span style="color: #008000;">#</span><span style="color: #008000;">将 /data下的文件打包放置 /tmp/目录</span>
ret = shutil.make_archive(<span style="color: #800000;">"</span><span style="color: #800000;">/tmp/data_bak</span><span style="color: #800000;">"</span>, <span style="color: #800000;">'</span><span style="color: #800000;">gztar</span><span style="color: #800000;">'</span>, root_dir=<span style="color: #800000;">'</span><span style="color: #800000;">/data</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>&nbsp;</p>
<p>2.9、shutil 对压缩包的处理是调用 ZipFile 和 TarFile 两个模块来进行的，详细：</p>
<p>2.9.1、ZipFile模块</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">import</span><span style="color: #000000;"> zipfile

</span><span style="color: #008000;">#</span><span style="color: #008000;">压缩</span>
z = zipfile.ZipFile(<span style="color: #800000;">'</span><span style="color: #800000;">test.zip</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">w</span><span style="color: #800000;">'</span><span style="color: #000000;">)
z.write(</span><span style="color: #800000;">'</span><span style="color: #800000;">a.log</span><span style="color: #800000;">'</span><span style="color: #000000;">)
z.write(</span><span style="color: #800000;">'</span><span style="color: #800000;">b.doc</span><span style="color: #800000;">'</span><span style="color: #000000;">)
z.close()

</span><span style="color: #008000;">#</span><span style="color: #008000;">解压</span>
z = zipfile.ZipFile(<span style="color: #800000;">'</span><span style="color: #800000;">test.zip</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">r</span><span style="color: #800000;">'</span><span style="color: #000000;">)
z.extractall(path</span>=<span style="color: #800000;">'</span><span style="color: #800000;">.</span><span style="color: #800000;">'</span><span style="color: #000000;">)
z.close()</span></pre>
</div>
<p>&nbsp;</p>
<p>2.9.2 TarFile模块</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">import</span><span style="color: #000000;"> TarFile

</span><span style="color: #008000;">#</span><span style="color: #008000;">压缩</span>
t = tarfile.open(<span style="color: #800000;">'</span><span style="color: #800000;">data.tar</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">w</span><span style="color: #800000;">'</span><span style="color: #000000;">)
t.add(</span><span style="color: #800000;">'</span><span style="color: #800000;">/test1/a.py</span><span style="color: #800000;">'</span>, arcname=<span style="color: #800000;">'</span><span style="color: #800000;">a.bak</span><span style="color: #800000;">'</span><span style="color: #000000;">)
t.add(</span><span style="color: #800000;">'</span><span style="color: #800000;">/test2/b.py</span><span style="color: #800000;">'</span>, arcname=<span style="color: #800000;">'</span><span style="color: #800000;">b.bak</span><span style="color: #800000;">'</span><span style="color: #000000;">)
t.close()

</span><span style="color: #008000;">#</span><span style="color: #008000;">解压</span>
t = tarfile.open(<span style="color: #800000;">'</span><span style="color: #800000;">data.tar</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">r</span><span style="color: #800000;">'</span><span style="color: #000000;">)
t.extractall(</span><span style="color: #800000;">'</span><span style="color: #800000;">/data</span><span style="color: #800000;">'</span><span style="color: #000000;">)
t.close()</span></pre>
</div>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>