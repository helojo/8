<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修Django学习笔记' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>Django学习笔记</center></div><div class='banquan'>原文出处:本文由博客园博主AlexLu0711提供。<br/>
原文连接:https://www.cnblogs.com/AlexLu/p/11395120.html</div><br>
    <h2 id="安装django">安装django</h2>
<ul>
<li><pre><code><code>  pip3 install django</code></pre></li>
</ul>
<h2 id="删除django">删除django</h2>
<ul>
<li><pre><code><code>  pip3 uninstall django</code></pre></li>
</ul>
<h2 id="创建django项目">创建django项目</h2>
<ul>
<li><pre><code><code>  # django-admin startproject 创建的项目名
  django-admin startproject mywebsite</code></pre></li>
</ul>
<h2 id="运行django项目">运行django项目</h2>
<ul>
<li><pre><code><code>  # 运行时需要进入到django目录
  python manage.py runserver</code></pre></li>
</ul>
<h2 id="创建django-app即django应用">创建django-app（即django应用）</h2>
<ul>
<li><pre><code><code>  # python manage.py startapp 应用名称
  python manage.py startapp news</code></pre></li>
</ul>
<h2 id="注册django-app">注册django-app</h2>
<ul>
<li><pre><code><code>  # 在项目下的settings文件中进行注册
  # 在INSTALLED_APPS中增加需要注册的应用名，如上news</code></pre></li>
</ul>
<h2 id="修改django界面默认语言为中文">修改django界面默认语言为中文</h2>
<pre class="python"><code># 在项目下的settings文件中进行设置
# LANGUAGE_CODE = &#39;en-us&#39;
LANGUAGE_CODE = &#39;zh-hans&#39;</code></pre>
<h2 id="创建django后台管理员用户与密码">创建django后台管理员用户与密码</h2>
<pre class="python"><code>python manage.py createsuperuser</code></pre>
<h1 id="mvt">MVT</h1>
<h2 id="mmodels">M——models</h2>
<blockquote>
<p>主要封装数据库，对数据库进行访问，对数据进行增删改查。</p>
</blockquote>
<h2 id="vviews">V——views</h2>
<blockquote>
<p>进行业务逻辑处理</p>
</blockquote>
<h2 id="ttemplates">T——templates</h2>
<blockquote>
<p>主要进行展示</p>
</blockquote>
<h1 id="url">URL</h1>
<h3 id="url标准语法">url标准语法</h3>
<pre class="html"><code>protocol://hostname[:port]/path/[:parameters][?query]#fragment</code></pre>
<ul>
<li>protocol：协议，如http、https、ftp、mailto、ldap、file、news、telnet</li>
<li>hostname：ip地址</li>
<li>port：端口</li>
<li>path：路径</li>
<li>parameters：参数</li>
<li>query：查询</li>
<li>fragment：锚点</li>
</ul>
<h2 id="path">Path</h2>
<h3 id="path标准语法">path()标准语法</h3>
<pre class="python"><code>path(&lt;route&gt;, &lt;view&gt;, [name=None], [**kwargs])</code></pre>
<ul>
<li>route：表示路径，从端口以后的URL地址，到/结束</li>
<li>view：表示route匹配成功后，需要调用的视图，view必须是个函数，如果class必须使用as_view()转换为函数</li>
<li>name：表示视图的别名</li>
<li>**kwags：以字典形式传递的参数</li>
</ul>
<h3 id="路径转换器">路径转换器</h3>
<pre class="python"><code>path(&#39;AlexLu/Eva/&lt;html&gt;&#39;, views.web, name=&#39;web&#39;),
# 其中&lt;html&gt;为传递给函数views.web的参数</code></pre>
<ul>
<li>str —— 用法：<code>&lt;str:html&gt;</code>匹配一个非空字符及，除去 ’/‘ ，默认使用的是这种方式</li>
<li>int —— <code>&lt;int:html&gt;</code>匹配0或正整数</li>
<li>slug —— <code>&lt;slug:html&gt;</code>由ASCII字母或数字组成，通过 ’-‘ 链接的字符串</li>
<li>uuid —— <code>&lt;uuid:html&gt;</code>uuid格式的字符串</li>
<li>path —— <code>&lt;path:html&gt;</code>匹配一个非空字符串，包括 ’/‘</li>
</ul>
<pre class="python"><code>path(&#39;index/&lt;str:html&gt;&#39;, views.index, name=&#39;index&#39;),
path(&#39;index/&lt;path:home&gt;&#39;, views.home, name=&#39;home&#39;),
path(&#39;page/&lt;int:page&gt;&#39;, views.page, name=&#39;page&#39;),
path(&#39;index/&lt;int:numa&gt;/&lt;int:numb&gt;&#39;, views.sum, name=&#39;sum&#39;),
path(&#39;slug/&lt;slug:slugstr&gt;&#39;, views.slugstr, name=&#39;slugstr&#39;),
path(&#39;uuid/&lt;uuid:uuid&gt;&#39;, views.uuid, name=&#39;uuid&#39;),

# ---------------------------------------------------------------------
def index(request, html):
    return HttpResponse(html)


def home(request, home):
    return HttpResponse(&#39;&lt;h1&gt;{}&lt;/h1&gt;&#39;.format(home))


def page(request, page):
    return HttpResponse(&#39;&lt;h1&gt;{}&lt;/h1&gt;&#39;.format(page))


def sum(request, numa, numb):
    return HttpResponse(&#39;&lt;h1&gt;{}&lt;/h1&gt;&#39;.format(numa+numb))


def slugstr(request, slugstr):
    return HttpResponse(&#39;&lt;h1&gt;{}&lt;/h1&gt;&#39;.format(slugstr))


def uuid(request, uuid):
    return HttpResponse(&#39;&lt;h1 &gt;{}&lt;/h1&gt;&#39;.format(uuid))</code></pre>
<h2 id="include">include</h2>
<h3 id="include的三种语法">include的三种语法</h3>
<h4 id="module">1. module</h4>
<ul>
<li>include(module, namespace=None)</li>
</ul>
<h4 id="namespace">2. namespace</h4>
<ul>
<li>include(pattern_list)</li>
</ul>
<h4 id="pattern_list">3. pattern_list</h4>
<ul>
<li>include((pattern_list, app_namespace), namespace=None)</li>
</ul>
<h4 id="include用法说明">include用法说明</h4>
<ul>
<li>module —— 表示一个模块（模型）文件</li>
<li>namespace —— 实例命名空间</li>
<li>pattern_list —— 必须是一个可迭代的path()或re_path()清单</li>
<li>app_namespace —— app命名空间</li>
</ul>
<h2 id="url地址重定向">URL地址重定向</h2>
<pre class="python"><code>redirect(to, permanent=False, *args, **kwargs)</code></pre>
<ul>
<li>to —— 指需要重新定位的位置，这个位置可以是一个视图，可以是一个url地址，也可以是一个模块</li>
<li>permanent —— 默认为False，用来表示是否永久重定向</li>
</ul>
<h2 id="reverse">Reverse</h2>
<pre class="python"><code>reverse(viewname, urlconf=None, args=None, kwargs=None, current_app=None)</code></pre>
<h1 id="http">HTTP</h1>
<h2 id="httpresponse">HttpResponse</h2>
<pre class="python"><code>HttpResponse(content, content_type=None, status=None, charset=None, reason=None *args, **kwargs)</code></pre>
<ul>
<li>content —— 返回给视图函数的内容</li>
<li>content_type —— 返回给视图函数的类型
<ul>
<li>text/html —— HTML文本字符串</li>
<li>text/plain —— 纯文本</li>
<li>text/css</li>
<li>text/javascript</li>
<li>application/xml —— xml文本</li>
<li>application/json —— json文本</li>
<li>multipart/form-data —— 上传文本</li>
</ul></li>
<li>status —— Http响应代码
<ul>
<li>200 —— 表示成功</li>
<li>404 —— 页面找不到</li>
</ul></li>
<li>charset —— 字符编码设置</li>
</ul>
<h2 id="常见的几种错误视图代码">常见的几种错误视图代码</h2>
<ul>
<li>404 page not found
<ul>
<li>找不到相应的页面</li>
</ul></li>
<li>500 server error
<ul>
<li>服务器错误</li>
</ul></li>
<li>400 bad request
<ul>
<li>无效的请求</li>
</ul></li>
<li>403 HTTP forbidden
<ul>
<li>HTTP禁止访问，权限不足</li>
</ul></li>
<li>200 OK
<ul>
<li>请求成功</li>
</ul></li>
</ul>
<h2 id="http请求方式">Http请求方式</h2>
<ul>
<li>介绍 —— HTTP 协议定义一些方法，以指明为获取客户端（如您的浏览器或我们的 CheckUpDown 机器人）所指定的具体网址资源而需要在 Web 服务器上执行的动作。则这些方法如下：
<ul>
<li>OPTIONS( 选项 ) ：查找适用于一个特定网址资源的通讯选择。 在不需执行具体的涉及数据传输的动作情况下， 允许客户端来确定与资源相关的选项以及 / 或者要求， 或是一个服务器的性能。</li>
<li>GET( 获取 ) ：检索由网址资源所确定的信息，如获取一个特定的网页或图片。这是最常用的方法。</li>
<li>HEAD( 头 ) ：除了服务器只反馈标头信息而不是网址资源所确定的信息本身外， 基本同于 GET ( 获取 ) 。 可用于获取一个请求所要求的响应实体的元信息 ( metainformation) ，而不需传输响应实体本身。 经常用来测试超文本链接的有效性， 可达性， 和最近的修改。</li>
<li>POST( 投寄 ) ：将数据提交到 Web 服务器，如 1 ）在电子公告板，新闻组中，或向 邮件名单发送信息， 2 ）提供输入数据 - 通常由一个公共网关接口(CGI) 表， 到 一个数据处理进程， 3 ）直接将记录添加到一个数据库中。</li>
<li>PUT( 放置 ) ：将一个具体网址的数据设置（ 置入 / 替换）成客户提交的新数据。例如，将新的网页上载给服务器。</li>
<li>DELETE( 删除 ) ：删除与网址资源相关的数据。例如，删除网页。</li>
<li>TRACE( 跟踪 ) ：运行请求信息的一个远程应用层回送。 实际上是一个 'ping', 用以测试 Web 服务器正在从客户端接收什么数据。</li>
<li>CONNECT( 连接 ) ：保留以便通过代理服务器和隧道一起使用（如 SSL ）。这种方法只在 HTTP 1.1 版中定义， 而在先前的 1.0 版中却没有。</li>
</ul></li>
</ul>
<h2 id="允许的http请求方式装饰器">允许的HTTP请求方式——装饰器</h2>
<h3 id="限定http请求方式">限定http请求方式</h3>
<pre class="python"><code>require_http_methods([Mthods_list])</code></pre>
<ul>
<li>Mthods_list为请求方式列表，如：[‘GET’, ‘POST’]</li>
</ul>
<h3 id="require_get">require_GET()</h3>
<ul>
<li>只允许使用get方式进行请求</li>
</ul>
<h3 id="require_post">require_POST()</h3>
<ul>
<li>只允许使用post方式进行请求</li>
</ul>
<h3 id="require_safe">require_safe()</h3>
<ul>
<li>只允许使用get方法和head方法的装饰器</li>
</ul>
<h1 id="render">Render</h1>
<ul>
<li><p>标准语法：</p>
<pre class="python"><code>render(&lt;request&gt;, &lt;template_name&gt;, context=None, content_type=None, status=None, using=None)</code></pre></li>
<li><p>必选参数</p>
<ul>
<li>request —— 生成HttpRequest对象</li>
<li>template_name —— 指定需要渲染的模板名称</li>
</ul></li>
<li><p>可选参数</p>
<ul>
<li>context —— 上下文，必须是一个字典。在HTML文件中使用字典的Key，通过Key展示对应的value</li>
<li>content_type —— 指定上下文类型</li>
<li>status —— 响应状态码</li>
<li>using —— 用于加载模板的引擎名称
<ul>
<li>Django templates language</li>
<li>jinjia2</li>
</ul></li>
</ul></li>
</ul>
<h1 id="过滤器">过滤器</h1>
<h2 id="first">first</h2>
<ul>
<li>返回列表list的第一个值</li>
</ul>
<h2 id="last">last</h2>
<ul>
<li>返回列表list的最后一个值</li>
</ul>
<h2 id="length">length</h2>
<ul>
<li>返回变量值的长度，可以用于字符串、列表</li>
</ul>
<h2 id="linebrakebr">linebrakebr</h2>
<ul>
<li>将纯文本文件中的换行转换为HTML中的换行符</li>
</ul>
<h2 id="linenumbers">linenumbers</h2>
<ul>
<li>显示行号</li>
</ul>
<h2 id="ljust">ljust</h2>
<ul>
<li>左对齐</li>
</ul>
<h2 id="rjust">rjust</h2>
<ul>
<li>右对齐</li>
</ul>
<h2 id="lower">lower</h2>
<ul>
<li>全部小写</li>
</ul>
<h2 id="upper">upper</h2>
<ul>
<li>全部大写</li>
</ul>
<h2 id="title">title</h2>
<ul>
<li>将首字母全部大写</li>
</ul>
<h2 id="wordcount">wordcount</h2>
<ul>
<li>统计单词的数量</li>
</ul>
<h1 id="mysql">mysql</h1>
<pre><code><code># 检查是否安装mysql
ps -aux | grep &#39;mysql&#39;
# 安装服务端
sudo apt-get install mysql-server
# 安装客户端
sudo apt-get install mysql-client

# 启动服务
sudo service mysql start
# 停止服务
sudo service mysql stop
# 重启服务
sudo service mysql restart

# 进入数据库
sudo mysql -uroot -p</code></pre>
<ul>
<li>取消mysql连接限制问题，否则每次进入数据库都需要在前面加上sudo</li>
</ul>
<pre class="mysql"><code># 进入管理员模式
alexlu@alexlu-Ubuntu:~$ sudo su
# 进入MySQL
root@alexlu-Ubuntu:/home/alexlu# mysql
# 查看用户权限
mysql&gt; select user,plugin from mysql.user;
# 更新root用户密码（此处密码设为‘root’）
mysql&gt; update mysql.user set authentication_string=PASSWORD(&#39;root&#39;),plugin=&#39;mysql_native_password&#39;;
# 刷新设置
mysql&gt; flush privileges;
# 退出MySQL与root用户
mysql&gt; exit;
root@alexlu-Ubuntu:/home/alexlu# exit
# 重启数据库服务
alexlu@alexlu-Ubuntu:~$ sudo service mysql restart
# 尝试重新登陆（前面不加sudo）
alexlu@alexlu-Ubuntu:~$ mysql -uroot -proot</code></pre>
<h2 id="数据库的创建与删除">数据库的创建与删除</h2>
<pre class="mysql"><code># 展示当前数据库：
mysql&gt; show databases;
# 创建数据库（django为数据库名称）-此处未设置中文编码
mysql&gt; create database django;
# 查看创建的数据库
mysql&gt; show create database django;
# 删除数据库
mysql&gt; drop database django;
# 创建支持中文编码的数据库
mysql&gt; create database django charset=&#39;utf8&#39;;</code></pre>
<h2 id="表的创建与删除">表的创建与删除</h2>
<pre class="mysql"><code># 查看当前使用的数据库
mysql&gt; select database();
# 选择使用的数据库
mysql&gt; use django_AlexLu;
# 创建表
mysql&gt; create table students(
    -&gt; id int primary key auto_increment not null,
    -&gt; name varchar(20),
    -&gt; age int default 20
    -&gt; );
# 显示创建的表
mysql&gt; show create table students;
# 显示表结构
mysql&gt; desc students;
# 显示已创建的表
mysql&gt; show tables;
# 向表中插入数据
mysql&gt; insert into students(name,age) values(&#39;Tom&#39;, 22);
# 查询表中的数据
mysql&gt; select * from students;</code></pre>
<h2 id="django连接mysql">Django连接MySQL</h2>
<ul>
<li>设置数据库连接项</li>
</ul>
<pre class="python"><code># 在django的settings.py文件中对DATABASES进行设置
DATABASES = {
    &#39;default&#39;: {
        # &#39;ENGINE&#39;: &#39;django.db.backends.sqlite3&#39;,
        # &#39;NAME&#39;: os.path.join(BASE_DIR, &#39;db.sqlite3&#39;),
        &#39;ENGINE&#39;: &#39;django.db.backends.mysql&#39;,
        &#39;NAME&#39;: &#39;django_AlexLu&#39;,
        &#39;USER&#39;: &#39;root&#39;,
        &#39;PASSWORD&#39;: &#39;root&#39;,
        &#39;HOST&#39;: &#39;localhost&#39;,
        &#39;PORT&#39;: 3306
    }
}</code></pre>
<ul>
<li>安装pymysql</li>
</ul>
<pre><code><code>pip install pymysql</code></pre>
<ul>
<li>配置pymysql</li>
</ul>
<pre class="python"><code># 在django项目下的__init__.py中进行设置
import pymysql
pymysql.install_as_MySQLdb()</code></pre>
<ul>
<li>可能会出现的错误</li>
</ul>
<pre><code><code>django.core.exceptions.ImproperlyConfigured: mysqlclient 1.3.13 or newer is required; you have 0.9.3.</code></pre>
<ul>
<li>解决办法</li>
</ul>
<pre><code><code># 安装libmysqlclient-dev
sudo apt-get install libmysqlclient-dev
# 安装mysqlclient
pip install mysqlclient
# 修改django项目下的__init__.py（去掉上面第3步增加的两行内容）改为：
import MySQLdb</code></pre>
<ul>
<li>补充（mysql开发包的安装）</li>
</ul>
<pre><code><code># Ubuntu
sudo apt-get install libmysqlclient-dev
# CentOS
yum install python-devel mysql-devel</code></pre>
<h2 id="mysql数据库迁移">MySQL数据库迁移</h2>
<pre><code><code># 生成迁移文件
python manage.py makemigrations
# 将迁移文件映射到数据库中
python manage.py migrate
# 如需强制迁移需要在上方命令后面加上 应用名</code></pre>
<h1 id="orm">ORM</h1>
<ul>
<li>Object Relational Mapping</li>
<li>ORM（类、对象、属性）——DB（数据表、数据行、字段）</li>
</ul>
<h2 id="流程说明">流程说明</h2>
<ol>
<li>创建models</li>
<li>通过models创建迁移文件（makemigrations）</li>
<li>通过迁移文件映射到数据库中（migrate）</li>
</ol>
<h2 id="将数据库表格信息展示在django后台">将数据库表格信息展示在django后台</h2>
<pre class="python"><code># 在app下的admin.py中进行设置
from django.contrib import admin
from .models import Articles
admin.site.register(Articles)</code></pre>
<h2 id="设置django后台展示出表格更多的列">设置django后台展示出表格更多的列</h2>
<pre class="python"><code># 在app文件下的admin.py中进行设置
from django.contrib import admin
from .models import Articles


class AritclesAdmin(admin.ModelAdmin):
    list_display = [&#39;id&#39;, &#39;title&#39;, &#39;content&#39;, &#39;author&#39;]


admin.site.register(Articles, AritclesAdmin)</code></pre>
<h2 id="设置django后台表结构显示中文列名">设置django后台表结构显示中文列名</h2>
<pre class="python"><code># 修改app下的模型文件models.py，在字段创建时设置中文名称
class Articles(models.Model):
    title = models.CharField(&#39;标题&#39;, max_length=20)
    author = models.CharField(&#39;作者&#39;, max_length=20)
    content = models.TextField(&#39;内容&#39;)</code></pre>
<ul>
<li>设置完成后需要重新对数据库进行迁移</li>
</ul>
<h2 id="数据库表格列字段设置为选项性别为可选项">数据库表格列字段设置为选项（性别为可选项）</h2>
<pre class="python"><code>class Students(models.Model):
    choices = [
        (&#39;male&#39;, &#39;男&#39;),
        (&#39;female&#39;, &#39;女&#39;)
    ]

    name = models.CharField(verbose_name=&#39;姓名&#39;, max_length=20, unique=True)
    age = models.CharField(verbose_name=&#39;年龄&#39;, max_length=10)
    gender = models.CharField(verbose_name=&#39;性别&#39;, max_length=10, choices=choices, default=&#39;male&#39;)
    is_deleted = models.BooleanField(default=False)
    introduce = models.TextField(verbose_name=&#39;自我介绍&#39;)</code></pre>
<h1 id="模型中的元数据meta">模型中的元数据（Meta）</h1>
<h2 id="设置django后台表名显示为中文">设置django后台表名显示为中文</h2>
<pre class="python"><code># 在app下的模型文件models.py中进行设置
class Articles(models.Model):
    title = models.CharField(&#39;标题&#39;, max_length=20)
    author = models.CharField(&#39;作者&#39;, max_length=20)
    content = models.TextField(&#39;内容&#39;)

    def __str__(self):
        return self.title

    class Meta:
        verbose_name_plural = &#39;新闻列表&#39;
        verbose_name = &#39;新闻&#39;</code></pre>
<ul>
<li>在表格模型定义中增加子类Meta，通过verbose_name_plural与verbose_name设置中文名称即可</li>
</ul>
<h2 id="设置django后台表结构列名的排序方式">设置django后台表结构列名的排序方式</h2>
<pre class="python"><code># 在模型定义下的Meta子类中增加ordering字段进行设置
    class Meta:
        verbose_name_plural = &#39;用户列表&#39;
        verbose_name = &#39;用户&#39;
        ordering = [&#39;age&#39;, &#39;-name&#39;]
        # ordering = [&#39;-id&#39;]</code></pre>
<h2 id="修改表格名称">修改表格名称</h2>
<pre class="python"><code># 同样是在Mate子类中增加db_table字段进行设置
    class Meta:
        verbose_name_plural = &#39;用户列表&#39;
        verbose_name = &#39;用户&#39;
        ordering = [&#39;age&#39;, &#39;-name&#39;]
        db_table = &#39;students&#39;</code></pre>
<h1 id="数据查询从数据库中获取数据">数据查询（从数据库中获取数据）</h1>
<h2 id="流程">流程</h2>
<ul>
<li>Model（database） → QuerySet（views → context） → html（templates）</li>
</ul>
<h3 id="查询表中全部数据">查询表中全部数据</h3>
<pre class="python"><code># 在视图views定义中，通过context传递给需要渲染的html
from django.shortcuts import render
from .models import Students
# Create your views here.


def index(request):
    student_list = Students.objects.all()    # 此处为获取表中所有数据
    context = {
        &#39;students&#39;: student_list
    }
    return render(request, &#39;index.html&#39;, context)</code></pre>
<pre class="html"><code># 在模板templates下的index.html中进行展示
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
{% for student in students %}
    &lt;h1&gt;{{ student.name }}——{{ student.age }}&lt;/h1&gt;
{% endfor %}
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<ul>
<li>需要配置好urls，此处忽略配置urls的内容，需要根据实际情况自行设置</li>
</ul>
<h3 id="查询表中某一条数据">查询表中某一条数据</h3>
<pre class="python"><code># 在视图views定义中，通过context传递给需要渲染的html
from django.shortcuts import render
from .models import Magnate
# Create your views here.


def index(request):
    context = {
        &#39;result&#39;: Magnate.objects.get(pk=1)    # 此处查询的值必须是唯一的
    }
    return render(request, &#39;index.html&#39;, context)</code></pre>
<pre class="html"><code># 在模板templates下的index.html中进行展示
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;{{ result.name }}&lt;/h1&gt;
    &lt;h1&gt;{{ result.age }}&lt;/h1&gt;
    &lt;h1&gt;{{ result.gender }}&lt;/h1&gt;
    &lt;h1&gt;{{ result.assets }}&lt;/h1&gt;
    &lt;h1&gt;{{ result.company }}&lt;/h1&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<h3 id="查询表中多条数据过滤条件的使用">查询表中多条数据（过滤条件的使用）</h3>
<pre class="python"><code># 在视图views定义中，通过context传递给需要渲染的html
from django.shortcuts import render
from .models import Magnate
# Create your views here.


def index(request):
    context = {
        &#39;female_list&#39;: Magnate.objects.filter(gender=&#39;female&#39;)
        # &#39;male_list&#39;: Magnate.objects.exclude(gender=&#39;female&#39;)
    }
    return render(request, &#39;index.html&#39;, context)</code></pre>
<pre class="html"><code># 在模板templates下的index.html中进行展示
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
{% for female in female_list %}
    &lt;h1&gt;{{ female.name }}——{{ female.assets }}&lt;/h1&gt;
{% endfor %}
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<ul>
<li>filter —— 查询结果为满足条件的记录</li>
<li>exclude —— 查询结果为不满足条件的记录</li>
</ul>
<h3 id="二次查询多次查询">二次查询（多次查询）</h3>
<pre class="python"><code># 在视图views定义中，通过context传递给需要渲染的html
from django.shortcuts import render
from .models import Magnate
# Create your views here.


def index(request):
    magnates = Magnate.objects.all().filter(gender=&#39;male&#39;).filter(assets=2125)
    context = {
        &#39;male_list&#39;: magnates
    }
    return render(request, &#39;index.html&#39;, context)</code></pre>
<pre class="html"><code># 在模板templates下的index.html中进行展示
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
{% for male in male_list %}
    &lt;h1&gt;{{ male.name }}——{{ male.assets }}&lt;/h1&gt;
{% endfor %}
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<h3 id="查询后排序">查询后排序</h3>
<pre class="python"><code># 在视图views定义中，通过context传递给需要渲染的html
from django.shortcuts import render
from .models import Magnate
# Create your views here.


def index(request):
    magnates = Magnate.objects.filter(gender=&#39;male&#39;).order_by(&#39;-age&#39;)
    context = {
        &#39;magnates&#39;: magnates
    }
    return render(request, &#39;index.html&#39;, context)</code></pre>
<pre class="html"><code># 在模板templates下的index.html中进行展示
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
{% for magnate in magnates %}
    &lt;h1&gt;{{ magnate.name }}——{{ magnate.gender }}——{{ magnate.age }}&lt;/h1&gt;
{% endfor %}
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<h3 id="通过某个字段进行查询">通过某个字段进行查询</h3>
<pre class="python"><code># 在视图views定义中，通过context传递给需要渲染的html
from django.shortcuts import render
from .models import Magnate
# Create your views here.


def index(request):
    magnates = Magnate.objects.values(&#39;name&#39;, &#39;assets&#39;)
    context = {
        &#39;magnates&#39;: magnates
    }
    return render(request, &#39;index.html&#39;, context)</code></pre>
<pre class="html"><code># 在模板templates下的index.html中进行展示
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
{% for magnate in magnates %}
    &lt;h1&gt;{{ magnate.name }}——{{ magnate.gender }}——{{ magnate.age }}&lt;/h1&gt;
{% endfor %}
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<ul>
<li>此处界面不会显示性别信息，因为在视图中查询时只设置了姓名与资产两个字段</li>
<li>values() 后括号为空时，查询所有字段，等价于 all()</li>
<li>values与all的区别为，前者以字典形式返回，后者以对象形式返回</li>
</ul>
<h3 id="模糊查询">模糊查询</h3>
<h4 id="以xxx开头或以xxx结尾">以xxx开头或以xxx结尾</h4>
<pre class="python"><code># views视图中filter括号中使用模糊匹配的字段即可
magnates = Magnate.objects.filter(company__startswith=&#39;阿里&#39;)</code></pre>
<ul>
<li>字段名__startswith：以xxx开头，对大小写敏感</li>
<li>字段名__isstartswith：以xxx开头</li>
<li>字段名__endswith：以xxx结尾，对大小写敏感</li>
<li>字段名__isendswith：以xxx结尾</li>
</ul>
<h4 id="in查询">in查询</h4>
<pre class="python"><code># views视图中filter括号中使用 字段名__in 即可
results = Magnate.objects.filter(age__in=[45, 58, 50])</code></pre>
<h3 id="范围查询">范围查询</h3>
<pre class="python"><code># views视图中filter括号中使用范围查询的字段即可
results = Magnate.objects.filter(age__range=(20, 45))</code></pre>
<ul>
<li>范围查询使用元组用来表示范围，只适用于数值型字段</li>
</ul>
<h3 id="判断条件查询">判断条件查询</h3>
<pre class="python"><code># views视图中filter括号中使用条件判断的字段即可
results = Magnate.objects.filter(assets__gt=1000)</code></pre>
<ul>
<li>字段名__gt：大于</li>
<li>字段名__gte：大于等于</li>
<li>字段名__lt：小于</li>
<li>字段名__lte：小于等于</li>
</ul>
<h1 id="向数据库中插入数据">向数据库中插入数据</h1>
<pre class="python"><code># 在视图views定义中，通过create设置需要插入的数据
Magnate.objects.create(name=&#39;AlexLu&#39;, age=50, gender=&#39;male&#39;, assets=666, company=&#39;创慧弘&#39;, introduce=&#39;CHH Co., Ltd.&#39;)</code></pre>
<h1 id="数据统计">数据统计</h1>
<pre class="python"><code># 在视图views定义中，通过count进行统计
from django.shortcuts import render
from .models import Magnate
# Create your views here.


def index(request):
    magnates = Magnate.objects.filter(gender=&#39;male&#39;).count()
    context = {
        &#39;count&#39;: magnates
    }
    return render(request, &#39;index.html&#39;, context)</code></pre>
<pre class="html"><code># 在模板templates下的index.html中进行展示
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;{{ count }}&lt;/h1&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<h2 id="count---sum---avg---max---min">Count - Sum - Avg - Max - Min</h2>
<pre class="python"><code># 需要在视图中导入相关统计函数
from django.db.models import Count, Sum, Avg, Max, Min
# 在视图中统计时通过aggregate进行调用
results = Magnate.objects.aggregate(Count(&#39;name&#39;), Sum(&#39;assets&#39;), Avg(&#39;assets&#39;), Max(&#39;assets&#39;), Min(&#39;assets&#39;))</code></pre>
<ul>
<li>返回值为字典形式：</li>
</ul>
<pre class="python"><code>{&#39;name__count&#39;: 10, &#39;assets__sum&#39;: 14446, &#39;assets__avg&#39;: 1444.6, &#39;assets__max&#39;: 2387, &#39;assets__min&#39;: 400}</code></pre>
<ul>
<li>也可通过filter过滤后调用对应的统计函数实现</li>
</ul>
<h1 id="表单">表单</h1>
<h2 id="创建表单">1. 创建表单</h2>
<pre class="python"><code># 在应用下创建forms.py
from django import forms


class RegisterForms(forms.Form):
    user_name = forms.CharField(min_length=8, max_length=20, label=&#39;用户名&#39;, initial=&#39;请输入您的手机号/密码&#39;)
    password = forms.CharField(widget=forms.PasswordInput, min_length=8, max_length=16, label=&#39;密码&#39;, help_text=&#39;密码为8-16位数字字母组合&#39;)
    repassword = forms.CharField(widget=forms.PasswordInput, min_length=8, max_length=16, label=&#39;确认密码&#39;)
    age = forms.IntegerField(min_value=18, max_value=100, label=&#39;年龄&#39;)
    # age = forms.Field(widget=forms.NumberInput, label=&#39;年龄&#39;)
    email = forms.EmailField(label=&#39;邮箱&#39;, disabled=True)
    phone = forms.CharField(max_length=11, label=&#39;手机号码&#39;, label_suffix=&#39;:(+86)&#39;)
    introduce = forms.CharField(label=&#39;自我介绍&#39;, widget=forms.Textarea)</code></pre>
<h2 id="创建表单视图将表单传递到前端页面">2. 创建表单视图（将表单传递到前端页面）</h2>
<pre class="python"><code># 在应用下的views.py中进行创建
from django.shortcuts import render
from .forms import RegisterForms
from django.views import View


class IndexForms(View):
    def get(self, request):
        forms = RegisterForms()
        return render(request, &#39;index.html&#39;, {&#39;forms&#39;: forms})</code></pre>
<h2 id="配置路由">3. 配置路由</h2>
<pre class="python"><code># 在应用下的urls.py中进行配置
urlpatterns = [
    path(&#39;&#39;, views.IndexForms.as_view(), name=&#39;form&#39;),
]</code></pre>
<h2 id="编写前端页面代码">4. 编写前端页面代码</h2>
<pre class="html"><code>{# 在应用下templates中创建index.html进行编写 #}
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Title&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form action=&quot;&quot; method=&quot;post&quot;&gt;
        &lt;table&gt;
            {{ forms.as_table }}    {#渲染成表格#}
            &lt;tr&gt;
                &lt;td&gt;&lt;input type=&quot;submit&quot; value=&quot;确认登陆&quot; name=&quot;submit&quot;&gt;&lt;/td&gt;
            &lt;/tr&gt;
        &lt;/table&gt;
    &lt;/form&gt;

&lt;hr&gt;

    &lt;form action=&quot;&quot; method=&quot;post&quot;&gt;
        &lt;div&gt;
            {{ forms.as_p }}    {#渲染成段落#}
            &lt;td&gt;&lt;input type=&quot;submit&quot; value=&quot;确认登陆&quot; name=&quot;submit&quot;&gt;&lt;/td&gt;
        &lt;/div&gt;
    &lt;/form&gt;

&lt;hr&gt;

    &lt;form action=&quot;&quot; method=&quot;post&quot;&gt;
        &lt;div&gt;
            {{ forms.as_ul }}    {#渲染成标签#}
            &lt;td&gt;&lt;input type=&quot;submit&quot; value=&quot;确认登陆&quot; name=&quot;submit&quot;&gt;&lt;/td&gt;
        &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<h2 id="前端界面美化增加css样式">5. 前端界面美化（增加CSS样式）</h2>
<h3 id="方法一">方法一</h3>
<pre class="html"><code>{# 直接在index.html文件中增加样式 #}
{# 在&lt;head&gt;标签中增加&lt;style&gt;标签设置相应控件的样式 #}
&lt;style&gt;
    #id_username{
        border-radius: 5px;
    }
&lt;/style&gt;</code></pre>
<h3 id="方法二">方法二</h3>
<pre class="python"><code># 在表单文件forms.py中为控件绑定样式类
from django import forms


class RegisterForms(forms.Form):
    username = forms.CharField(min_length=8, max_length=20, label=&#39;用户名&#39;, initial=&#39;请输入您的手机号/密码&#39;, widget=forms.TextInput(attrs={&#39;class&#39;: &#39;custom-forms&#39;}))
    password = forms.CharField(widget=forms.PasswordInput(attrs={&#39;class&#39;: &#39;custom-forms&#39;}), min_length=8, max_length=16, label=&#39;密码&#39;, help_text=&#39;密码为8-16位数字字母组合&#39;)
    repassword = forms.CharField(widget=forms.PasswordInput(attrs={&#39;class&#39;: &#39;custom-forms&#39;}), min_length=8, max_length=16, label=&#39;确认密码&#39;)
    age = forms.IntegerField(min_value=18, max_value=100, label=&#39;年龄&#39;, widget=forms.TextInput(attrs={&#39;class&#39;: &#39;custom-forms&#39;}))
    # age = forms.Field(widget=forms.NumberInput, label=&#39;年龄&#39;)
    email = forms.EmailField(label=&#39;邮箱&#39;, disabled=True, widget=forms.TextInput(attrs={&#39;class&#39;: &#39;custom-forms&#39;}))
    phone = forms.CharField(max_length=11, label=&#39;手机号码&#39;, label_suffix=&#39;:(+86)&#39;, widget=forms.TextInput(attrs={&#39;class&#39;: &#39;custom-forms&#39;}))
    introduce = forms.CharField(label=&#39;自我介绍&#39;, widget=forms.Textarea(attrs={&#39;class&#39;: &#39;custom-forms-textarea&#39;}))</code></pre>
<pre class="html"><code>{# 在&lt;head&gt;标签中增加&lt;style&gt;标签设置控件对应样式类的属性 #}
&lt;style&gt;
    .custom-forms{
        border-radius: 5px;
    }
    .custom-forms-textarea{
        border-radius: 15px;
    }
&lt;/style&gt;</code></pre>
<h2 id="选择控件">6. 选择控件</h2>
<pre class="python"><code># 直接在表单文件form.py中定义控件时设置
from django import forms


class RegisterForms(forms.Form):
    choices_item = [
        (1, &#39;男&#39;), (2, &#39;女&#39;), (3, &#39;保密&#39;)
    ]
    # 下拉列表
    gender = forms.ChoiceField(label=&#39;性别&#39;, choices=choices_item, nitial=3)
    # 单选
    gender2 = forms.ChoiceField(label=&#39;性别&#39;, choices=choices_item, widget=forms.RadioSelect, initial=2)
    # 复选
    gender3 = forms.MultipleChoiceField(label=&#39;性别&#39;, choices=choices_item, widget=forms.CheckboxSelectMultiple, initial=1)</code></pre>
<h2 id="日期控件">7. 日期控件</h2>
<pre class="python"><code>from django import forms


class RegisterForms(forms.Form):
    formats = [
        &#39;%Y-%m-%d&#39;,  # &#39;2019-6-30&#39;
        &#39;%m/%d/%Y&#39;,  # &#39;06/30/2019&#39;
        &#39;%m/%d/%y&#39;,  # &#39;06/30/19&#39;
    ]
    # 日期输入框
    birthday = forms.DateField(label=&#39;出生日期&#39;, input_formats=formats)

    year_list = [
        1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000
    ]
    # 日期选择框
    birthday2 = forms.DateField(label=&#39;出生日期&#39;, input_formats=formats, widget=forms.SelectDateWidget(years=year_list))</code></pre>
<h3 id="日期控件数据验证">日期控件数据验证</h3>
<pre class="python"><code># 在应用下的views.py中的控件类视图中通过forms.is_valid()进行验证
from django.shortcuts import render, HttpResponse
from .forms import RegisterForms
from django.views import View


class IndexForms(View):
    def get(self, request):
        forms = RegisterForms()
        return render(request, &#39;index.html&#39;, {&#39;forms&#39;: forms})

    def post(self, request):
        forms = RegisterForms(request.POST)
        if forms.is_valid():
            birthday = forms.cleaned_data.get(&#39;birthday&#39;)
            return render(request, &#39;home.html&#39;, {&#39;birthday&#39;: birthday})
        else:
            return HttpResponse(&#39;&lt;h1&gt;对不起，您输入的出生日期有误～！&lt;/h1&gt;&#39;)</code></pre>
<pre class="html"><code>{# 可通过home.html获取数据并展示 #}
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;欢迎登陆Django后台管理系统&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;{{ birthday }}&lt;/h1&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<h2 id="获取表单数据">8. 获取表单数据</h2>
<pre class="python"><code># django项目的应用下的forms.py
from django import forms


class RegisterForms(forms.Form):
    choices_item = [
        (1, &#39;男&#39;), (2, &#39;女&#39;), (3, &#39;保密&#39;)
    ]
    hobbies = [
        (1, &#39;足球&#39;), (2, &#39;篮球&#39;), (3, &#39;Python&#39;)
    ]
    year_list = [
        1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000
    ]

    username = forms.CharField(min_length=8, max_length=20, label=&#39;用户名&#39;, initial=&#39;请输入您的手机号/密码&#39;, widget=forms.TextInput(attrs={&#39;class&#39;: &#39;custom-forms&#39;}))
    password = forms.CharField(widget=forms.PasswordInput(attrs={&#39;class&#39;: &#39;custom-forms&#39;}), min_length=8, max_length=16, label=&#39;密码&#39;, help_text=&#39;密码为8-16位数字字母组合&#39;)
    repassword = forms.CharField(widget=forms.PasswordInput(attrs={&#39;class&#39;: &#39;custom-forms&#39;}), min_length=8, max_length=16, label=&#39;确认密码&#39;)
    gender = forms.ChoiceField(label=&#39;性别&#39;, choices=choices_item, nitial=3)
    age = forms.IntegerField(min_value=18, max_value=100, label=&#39;年龄&#39;, widget=forms.NumberInput(attrs={&#39;class&#39;: &#39;custom-forms&#39;}))
    birthday = forms.DateField(required=False, label=&#39;出生日期&#39;, widget=forms.SelectDateWidget(years=year_list))
    hobby = forms.MultipleChoiceField(label=&#39;爱好&#39;, choices=hobbies, widget=forms.CheckboxSelectMultiple)
    introduce = forms.CharField(label=&#39;自我介绍&#39;, widget=forms.Textarea(attrs={&#39;class&#39;: &#39;custom-forms-textarea&#39;}))</code></pre>
<pre class="python"><code># 应用下的视图文件views.py中编写表单对应的类视图
from django.shortcuts import render, HttpResponse
from .forms import RegisterForms
from django.views import View


class IndexForms(View):
    def get(self, request):
        forms = RegisterForms()
        return render(request, &#39;index.html&#39;, {&#39;forms&#39;: forms})

    def post(self, request):
        forms = RegisterForms(request.POST)
        if forms.is_valid():
            username = forms.cleaned_data.get(&#39;username&#39;)
            password = forms.cleaned_data[&#39;password&#39;]
            context = {
                # 以字典形式处理表单数据
                &#39;datalist&#39;: {
                    &#39;username&#39;: username,
                    &#39;password&#39;: password,
                    &#39;repassword&#39;: repassword,
                    &#39;age&#39;: age,
                    &#39;gender&#39;: gender,
                    &#39;birthday&#39;: birthday,
                    &#39;hobby&#39;: hobby,
                    &#39;introduce&#39;: introduce,
                },
                # 以列表形式处理表单数据
                &#39;datalist2&#39;: [
                    username,
                    password,
                    repassword,
                    age,
                    gender,
                    birthday,
                    hobby,
                    introduce,
                ],
            }
            return render(request, &#39;home.html&#39;, context=context)
        else:
            return HttpResponse(&#39;&lt;h1&gt;对不起，您输入的信息有误～！&lt;/h1&gt;&#39;)</code></pre>
<pre class="html"><code>{# 通过home.html接收表单数据并展示 #}
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;欢迎登陆Django后台管理系统&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

{#接收字典形式数据#}
{% for k, v in datalist.items %}
    &lt;h1&gt;{{ k }}---{{ v }}&lt;/h1&gt;
{% endfor %}

&lt;hr&gt;

{#接收列表形式数据#}
{% for field in datalist2 %}
    &lt;h1&gt;{{ field }}&lt;/h1&gt;
{% endfor %}

&lt;/body&gt;
&lt;/html&gt;</code></pre>
<h1 id="模型表单modelform">模型表单（ModelForm）</h1>
<h2 id="在模型文件models.py中设置好数据库映射">1. 在模型文件models.py中设置好数据库映射</h2>
<pre class="python"><code>from django.db import models


class Magnate(models.Model):
    choices = [
        (&#39;male&#39;, &#39;男&#39;),
        (&#39;female&#39;, &#39;女&#39;)
    ]

    name = models.CharField(verbose_name=&#39;姓名&#39;, max_length=20, unique=True)
    age = models.CharField(verbose_name=&#39;年龄&#39;, max_length=10)
    gender = models.CharField(verbose_name=&#39;性别&#39;, max_length=10, choices=choices, default=&#39;male&#39;)
    assets = models.IntegerField(verbose_name=&#39;资产&#39;)
    company = models.CharField(verbose_name=&#39;公司&#39;, max_length=50)
    is_deleted = models.BooleanField(default=False)
    introduce = models.TextField(verbose_name=&#39;介绍&#39;)

    class Meta:
        verbose_name_plural = &#39;富豪榜&#39;
        verbose_name = &#39;富豪&#39;
        ordering = [&#39;id&#39;]</code></pre>
<h2 id="建立模型表单">2. 建立模型表单</h2>
<pre class="python"><code># 在应用下的forms.py中进行建立
from django import forms
from .models import Magnate


class MagnatesForms(forms.ModelForm):
    class Meta:
        model = Magnate
        # 获取全部字段
        # fields = &#39;__all__&#39;
        # 指定过滤掉字段‘isdeleted’
        # exclude = [&#39;is_deleted&#39;]
        # 指定获取的字段列表
        fields = [&#39;name&#39;, &#39;age&#39;, &#39;assets&#39;, &#39;company&#39;]</code></pre>
<h2 id="创建模型表单对应的视图">3. 创建模型表单对应的视图</h2>
<pre class="python"><code># 在应用下的views.py中进行创建
from django.shortcuts import render, HttpResponse
from .models import Magnate
from .forms import MagnatesForms
from django.views import View


class IndexMagnate(View):
    def get(self, request):
        forms = MagnatesForms()
        return render(request, &#39;index.html&#39;, {&#39;forms&#39;: forms})</code></pre>
<h2 id="前端页面展示模型表单">4. 前端页面展示模型表单</h2>
<pre class="html"><code>{# 在应用中templates下的index.html进行展示 #}
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Title&lt;/title&gt;
    &lt;style&gt;
        .custom-forms{
            border-radius: 5px;
        }
        .custom-forms-textarea{
            border-radius: 15px;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form action=&quot;&quot; method=&quot;post&quot;&gt;
        &lt;div&gt;
            {{ forms.as_p }}    {#渲染成段落#}
            &lt;td&gt;&lt;input type=&quot;submit&quot; value=&quot;确认登陆&quot; name=&quot;submit&quot;&gt;&lt;/td&gt;
        &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<h2 id="为模型表单页面配置路由">5. 为模型表单页面配置路由</h2>
<pre class="python"><code># 在项目的路由文件urls.py中通过include关联到应用路由
from django.contrib import admin
from django.urls import path, include
from news import urls as news_urls

urlpatterns = [
    path(&#39;admin/&#39;, admin.site.urls),
    path(&#39;&#39;, include(news_urls)),
]</code></pre>
<pre class="python"><code># 在应用下的路由文件urls.py中将创建的模型表单视图与路径进行匹配
from django.urls import path
from news import views

urlpatterns = [
    path(&#39;&#39;, views.IndexMagnate.as_view(), name=&#39;magnate&#39;),
]</code></pre>
<h2 id="为模型表单增加字段">为模型表单增加字段</h2>
<pre class="python"><code># 直接在forms.py中的模型表单定义中增加
# 此处增加了password与repassword两个字段
from django import forms
from .models import Magnate


class MagnatesForms(forms.ModelForm):
    password = forms.CharField(widget=forms.PasswordInput(attrs={&#39;class&#39;: &#39;custom-forms&#39;}), min_length=8, max_length=16, label=&#39;密码&#39;, help_text=&#39;密码为8-16位数字字母组合&#39;)
    repassword = forms.CharField(widget=forms.PasswordInput(attrs={&#39;class&#39;: &#39;custom-forms&#39;}), min_length=8, max_length=16, label=&#39;确认密码&#39;)

    class Meta:
        model = Magnate
        # 获取全部字段
        # fields = &#39;__all__&#39;
        # 指定过滤掉字段‘isdeleted’
        # exclude = [&#39;is_deleted&#39;]
        # 指定获取的字段列表————可用来调整显示顺序
        fields = [&#39;name&#39;, &#39;gender&#39;, &#39;age&#39;, &#39;password&#39;, &#39;repassword&#39;, &#39;assets&#39;, &#39;company&#39;]</code></pre>
<h2 id="为模型表单渲染css样式">为模型表单渲染CSS样式</h2>
<pre class="python"><code># 直接在forms.py中的模型表单定义下增加widgets通过字典为相应的字段绑定控件及CSS样式
from django import forms
from .models import Magnate


class MagnatesForms(forms.ModelForm):
    password = forms.CharField(widget=forms.PasswordInput(attrs={&#39;class&#39;: &#39;custom-forms&#39;}), min_length=8, max_length=16, label=&#39;密码&#39;, help_text=&#39;密码为8-16位数字字母组合&#39;)
    repassword = forms.CharField(widget=forms.PasswordInput(attrs={&#39;class&#39;: &#39;custom-forms&#39;}), min_length=8, max_length=16, label=&#39;确认密码&#39;)

    class Meta:
        model = Magnate
        # 获取全部字段
        # fields = &#39;__all__&#39;
        # 指定过滤掉字段‘isdeleted’
        # exclude = [&#39;is_deleted&#39;]
        # 指定获取的字段列表————可用来调整显示顺序
        fields = [&#39;name&#39;, &#39;gender&#39;, &#39;age&#39;, &#39;password&#39;, &#39;repassword&#39;, &#39;assets&#39;, &#39;company&#39;]
        widgets = {
            &#39;name&#39;: forms.TextInput(attrs={&#39;class&#39;: &#39;custom-textinput&#39;}),
            &#39;introduce&#39;: forms.Textarea(attrs={&#39;class&#39;: &#39;custom-textinput&#39;, &#39;row&#39;: 30, &#39;cols&#39;: 80}),
        }</code></pre>
<pre class="html"><code>{# 在html中为控件设定CSS样式 #}
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Title&lt;/title&gt;
    &lt;style&gt;
        .custom-forms{
            border-radius: 5px;
        }
        .custom-forms-textarea{
            border-radius: 15px;
        }
        .custom-textinput{
            border: 5px solid #00ff00;
            border-radius: 5px;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form action=&quot;&quot; method=&quot;post&quot;&gt;
        &lt;div&gt;
            {{ forms.as_p }}    {#渲染成段落#}
            &lt;td&gt;&lt;input type=&quot;submit&quot; value=&quot;确认登陆&quot; name=&quot;submit&quot;&gt;&lt;/td&gt;
        &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<h1 id="表单的手动渲染">表单的手动渲染</h1>
<h2 id="普通表单的手动渲染">普通表单的手动渲染</h2>
<pre class="html"><code># 利用前端知识在html中直接进行样式设置
&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;
    &lt;hr&gt;
    &lt;ul&gt;
        &lt;li style=&quot;list-style-type: none;&quot;&gt;
            &lt;span style=&quot;color: #ff0000&quot;&gt;
                {{ forms.username.label }} :
            &lt;/span&gt;
            &lt;span&gt;
                {{ forms.username }}
            &lt;/span&gt;
            &lt;span style=&quot;margin-left: 10px&quot;&gt;
                {{ forms.username.help_text }}
            &lt;/span&gt;
        &lt;/li&gt;
    &lt;/ul&gt;
    &lt;hr&gt;
    &lt;td&gt;&lt;input type=&quot;submit&quot; value=&quot;确认登陆&quot; name=&quot;submit&quot;&gt;&lt;/td&gt;
&lt;/form&gt;</code></pre>
<h2 id="模型表单的手动渲染">模型表单的手动渲染</h2>
<pre class="python"><code># 直接在模型表单定义中增加前端需要界面展示的信息，并在html中进行渲染
from django import forms
from .models import Magnate


class MagnatesForms(forms.ModelForm):
    password = forms.CharField(widget=forms.PasswordInput(attrs={&#39;class&#39;: &#39;custom-forms&#39;}), min_length=8, max_length=16, label=&#39;密码&#39;, help_text=&#39;密码为8-16位数字字母组合&#39;)
    repassword = forms.CharField(widget=forms.PasswordInput(attrs={&#39;class&#39;: &#39;custom-forms&#39;}), min_length=8, max_length=16, label=&#39;确认密码&#39;)

    class Meta:
        model = Magnate
        # 获取全部字段
        # fields = &#39;__all__&#39;
        # 指定过滤掉字段‘isdeleted’
        # exclude = [&#39;is_deleted&#39;]
        # 指定获取的字段列表————可用来调整显示顺序
        fields = [&#39;name&#39;, &#39;gender&#39;, &#39;age&#39;, &#39;password&#39;, &#39;repassword&#39;, &#39;assets&#39;, &#39;company&#39;]
        widgets = {
            &#39;name&#39;: forms.TextInput(attrs={&#39;class&#39;: &#39;custom-textinput&#39;}),
            &#39;introduce&#39;: forms.Textarea(attrs={&#39;class&#39;: &#39;custom-textinput&#39;, &#39;row&#39;: 30, &#39;cols&#39;: 80}),
        }
        help_texts = {
            &#39;name&#39;: &#39;请输入中文姓名全称&#39;,
        }
        labels = {
            &#39;name&#39;: &#39;中文姓名&#39;,
        }</code></pre>
<h1 id="模型表单的数据保存mysql">模型表单的数据保存（MySQL）</h1>
<pre class="python"><code># 连接好MySQL数据库，在模型表单视图中post方法内进行数据获取和保存
from django.shortcuts import render, HttpResponse
from .models import Magnate
from .forms import MagnatesForms
from django.views import View


class IndexMagnate(View):
    def get(self, request):
        forms = MagnatesForms()
        return render(request, &#39;index.html&#39;, {&#39;forms&#39;: forms})

    def post(self, request):
        forms = MagnatesForms(request.POST)
        if forms.is_valid():
            forms.save()
            return HttpResponse(&#39;&lt;h1&gt;数据保存成功！&lt;/h1&gt;&#39;)
        else:
            return HttpResponse(&#39;&lt;h1&gt;数据保存失败！&lt;/h1&gt;&#39;)</code></pre>
<h1 id="未完待续">未完待续</h1>
<blockquote>
<p>以上学习笔记是根据视频教程 <a href="https://study.163.com/course/courseMain.htm?courseId=1209164807">Python之Django企业开发实战</a> 的思路进行初步整理，待内容完整后进行重新梳理。</p>
<p>最后感谢陈老师详细的教学视频。</p>
</blockquote>

</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>