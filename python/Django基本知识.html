<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修Django基本知识' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>Django基本知识</center></div><div class='banquan'>原文出处:本文由博客园博主林染提供。<br/>
原文连接:https://www.cnblogs.com/zengyi1995/p/11328946.html</div><br>
    <h3 class="md-end-block md-heading"><em><strong><span class="md-plain">一、安装及使用</span></strong></em></h3>
<ul>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">下载安装</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">命令行：pip3 install django==1.11.21</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">pycharm</span></p>
</li>
</ul>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">创建项目</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">命令行：</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">找一个文件夹存放项目文件，打开终端：</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">django-admin startproject 项目名称</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">项目目录</span></p>
</li>
</ul>
<p class="md-end-block md-p"><span class="md-image md-img-loaded" data-src="E:/video/s21day52/%E4%BB%A3%E7%A0%81/asset/1560226751493.png"><img src="file://E:/video/s21day52/%E4%BB%A3%E7%A0%81/asset/1560226751493.png?lastModify=1565343731" alt="" data-alt="1560226751493" /></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">pycahrm</span></p>
</li>
</ul>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">启动</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">命令行</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">切换到项目的根目录下 manage.py</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span><code>python36 manage.py runserver</code><span class="md-plain"> &mdash;&mdash; 127.0.0.1:80` </span></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span><code>python36 manage.py runserver 80</code><span class="md-plain">&mdash;&mdash;127.0.0.1:80</span></span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span><code>python36 manage.py runserver 0.0.0.0:80</code><span class="md-plain">&mdash;&mdash;0.0.0.0:80</span></span></p>
</li>
</ul>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">pycharm：点绿三角启动 可配置</span></p>
</li>
</ul>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">简单使用</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">示例：返回HTML指定文件</span></p>
</li>
</ul>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> 在urls.py中</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 导入</span>
<span style="color: #0000ff;">from</span> django.shortcuts <span style="color: #0000ff;">import</span><span style="color: #000000;"> HttpResponse,render
​
</span><span style="color: #008000;">#</span><span style="color: #008000;"> 函数</span>
<span style="color: #0000ff;">def</span><span style="color: #000000;"> index(request):
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> return HttpResponse('index')</span>
    <span style="color: #0000ff;">return</span> render(request,<span style="color: #800000;">'</span><span style="color: #800000;">index.html</span><span style="color: #800000;">'</span><span style="color: #000000;">)
​
</span><span style="color: #008000;">#</span><span style="color: #008000;"> url和函数对应关系</span>
urlpatterns =<span style="color: #000000;"> [
    url(r</span><span style="color: #800000;">'</span><span style="color: #800000;">^admin/</span><span style="color: #800000;">'</span><span style="color: #000000;">, admin.site.urls),
    url(r</span><span style="color: #800000;">'</span><span style="color: #800000;">^index/</span><span style="color: #800000;">'</span><span style="color: #000000;">, index),
]</span>&nbsp;</pre>
</div>
</li>
</ul>
<h3 class="md-end-block md-heading"><strong><em><span class="md-plain">二、静态文件</span></em></strong></h3>
<ul>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">配置</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">在settings.py中设置</span></p>
</li>
</ul>
<div class="cnblogs_code">
<pre><code>STATIC_URL = <span style="color: #800000;">'</span><span style="color: #800000;">/static/</span><span style="color: #800000;">'</span>          <span style="color: #008000;">#</span><span style="color: #008000;"> 别名</span>
STATICFILES_DIRS = [            <span style="color: #008000;">#</span><span style="color: #008000;"> 设置文件路径，可以设置多个</span>
    os.path.join(BASE_DIR, <span style="color: #800000;">'</span><span style="color: #800000;">static1</span><span style="color: #800000;">'</span><span style="color: #000000;">),
    os.path.join(BASE_DIR, </span><span style="color: #800000;">'</span><span style="color: #800000;">static</span><span style="color: #800000;">'</span><span style="color: #000000;">),
    os.path.join(BASE_DIR, </span><span style="color: #800000;">'</span><span style="color: #800000;">static2</span><span style="color: #800000;">'</span><span style="color: #000000;">),
]  </span></pre>
</div>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">使用</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">在路径前添加别名：/static/</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">多个文件路径，也是使用同一个别名，不是文件名</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">如果别名后的路径名相同，按照STATICFILES_DIRS列表的顺序进行查找</span></p>
</li>
</ul>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">link </span><span style="color: #ff0000;">rel</span><span style="color: #0000ff;">="stylesheet"</span><span style="color: #ff0000;"> href</span><span style="color: #0000ff;">="/static/css/login.css"</span><span style="color: #0000ff;">&gt;</span>         {# 别名开头 #}&nbsp;</pre>
</div>
</li>
</ul>
<h3 class="md-end-block md-heading"><em><strong><span class="md-plain">三、简单的登录实例</span></strong></em></h3>
<ul>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">form表单提交数据注意的问题：</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">提交的地址：action=""，请求的方式：method="post"</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">所有的input框有name属性，如name="username"</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">有一个input框的type="submit"或者有一个button</span></p>
</li>
</ul>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">提交post请求，由于Django中有一个csrf校验，所有请求会出问题</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">解决方式：把settings中MIDDLEWARE的'django.middleware.csrf.CsrfViewMiddleware'注释掉</span></p>
</li>
</ul>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">重定向</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">导入：from django.shortcuts import redirect</span></p>
</li>
</ul>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">使用方式</span></p>
</li>
</ul>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">#</span><span style="color: #008000;"> 在函数中使用,例如</span>
<span style="color: #0000ff;">return</span> redirect(<span style="color: #800000;">'</span><span style="color: #800000;">/index/</span><span style="color: #800000;">'</span>)      <span style="color: #008000;">#</span><span style="color: #008000;"> 参数：路径url</span><span style="color: #008000;">
#</span><span style="color: #008000;"> 注意：前面必须加/，代表从url根拼接，否则就会在当前url后面一直拼接</span></pre>
</div>
<div class="cnblogs_code" onclick="cnblogs_code_show('2eb0ebd4-6b48-4ba2-ac36-4de04d9870e5')"><img id="code_img_closed_2eb0ebd4-6b48-4ba2-ac36-4de04d9870e5" class="code_img_closed" src="./images/Django基本知识1.png" alt="" /><img id="code_img_opened_2eb0ebd4-6b48-4ba2-ac36-4de04d9870e5" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('2eb0ebd4-6b48-4ba2-ac36-4de04d9870e5',event)" src="./images/Django基本知识2.png" alt="" />
<div id="cnblogs_code_open_2eb0ebd4-6b48-4ba2-ac36-4de04d9870e5" class="cnblogs_code_hide">
<pre><code><span style="color: #0000ff;">from</span> django.shortcuts <span style="color: #0000ff;">import</span><span style="color: #000000;"> HttpResponse, render, redirect
​
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> index(request):
    </span><span style="color: #008000;">#</span><span style="color: #008000;"> return HttpResponse('index')</span>
    <span style="color: #0000ff;">return</span> render(request, <span style="color: #800000;">'</span><span style="color: #800000;">index.html</span><span style="color: #800000;">'</span><span style="color: #000000;">)
​
</span><span style="color: #0000ff;">def</span><span style="color: #000000;"> login(request):
    </span><span style="color: #0000ff;">if</span> request.method == <span style="color: #800000;">'</span><span style="color: #800000;">POST</span><span style="color: #800000;">'</span><span style="color: #000000;">:
        </span><span style="color: #008000;">#</span><span style="color: #008000;"> 获取form表单提交的书籍</span>
        username = request.POST[<span style="color: #800000;">'</span><span style="color: #800000;">username</span><span style="color: #800000;">'</span><span style="color: #000000;">]
        password </span>= request.POST[<span style="color: #800000;">'</span><span style="color: #800000;">password</span><span style="color: #800000;">'</span><span style="color: #000000;">]
        </span><span style="color: #008000;">#</span><span style="color: #008000;"> 验证用户名和密码</span>
        <span style="color: #0000ff;">if</span> models.User.objects.filter(username=username,password=<span style="color: #000000;">password):
            </span><span style="color: #008000;">#</span><span style="color: #008000;"> 验证成功跳转到index页面</span>
            <span style="color: #008000;">#</span><span style="color: #008000;"> return redirect('https://www.baidu.com/')</span>
            <span style="color: #0000ff;">return</span> redirect(<span style="color: #800000;">'</span><span style="color: #800000;">/index/</span><span style="color: #800000;">'</span><span style="color: #000000;">)
        </span><span style="color: #008000;">#</span><span style="color: #008000;"> 不成功 重新登录</span>
    <span style="color: #0000ff;">return</span> render(request, <span style="color: #800000;">'</span><span style="color: #800000;">login.html</span><span style="color: #800000;">'</span><span style="color: #000000;">)
​
urlpatterns </span>=<span style="color: #000000;"> [
    url(r</span><span style="color: #800000;">'</span><span style="color: #800000;">^admin/</span><span style="color: #800000;">'</span><span style="color: #000000;">, admin.site.urls),
    url(r</span><span style="color: #800000;">'</span><span style="color: #800000;">^index/</span><span style="color: #800000;">'</span><span style="color: #000000;">, views.index),
    url(r</span><span style="color: #800000;">'</span><span style="color: #800000;">^login/</span><span style="color: #800000;">'</span><span style="color: #000000;">, views.login),
]</span></pre>
</div>
<span class="cnblogs_code_collapse">示例</span></div>
</li>
</ul>
<h3 class="md-end-block md-heading"><em><strong><span class="md-plain">四、app</span></strong></em></h3>
<ul>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">创建app</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">命令行：python manage.py startapp app名称</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">pycharm：tools --&gt; run manage.py task --&gt; 输入命令：startapp app名称</span></p>
</li>
</ul>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">注册app</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">在settings.py中设置，例：app名为app01</span></p>
</li>
</ul>
<div class="cnblogs_code">
<pre><code>INSTALLED_APPS =<span style="color: #000000;"> [
    ...
    </span><span style="color: #800000;">'</span><span style="color: #800000;">app01</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">app01.apps.App01Config</span><span style="color: #800000;">'</span>,       <span style="color: #008000;">#</span><span style="color: #008000;"> 推荐写法</span>
]&nbsp;</pre>
</div>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">app中的文件</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">migrations：存放迁移文件的</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">admin.py：Django提供的后台管理工具</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">app.py：与app信息相关的</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">models.py：跟ORM有关的内容</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">views.py：视图，写函数的</span></p>
</li>
</ul>
</li>
</ul>
<h3 class="md-end-block md-heading"><em><strong><span class="md-plain">五、使用MySQL流程</span></strong></em></h3>
<ul>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">创建一个MySQL数据库：create database day53;</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">在settings.py中设置，Django连接MySQL数据库：</span></p>
<div class="cnblogs_code">
<pre><code>DATABASES =<span style="color: #000000;"> {
    </span><span style="color: #800000;">'</span><span style="color: #800000;">default</span><span style="color: #800000;">'</span><span style="color: #000000;">: {
        </span><span style="color: #800000;">'</span><span style="color: #800000;">ENGINE</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">django.db.backends.mysql</span><span style="color: #800000;">'</span>,      <span style="color: #008000;">#</span><span style="color: #008000;"> 引擎 </span>
        <span style="color: #800000;">'</span><span style="color: #800000;">NAME</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">day53</span><span style="color: #800000;">'</span>,                         <span style="color: #008000;">#</span><span style="color: #008000;"> 数据库名称</span>
        <span style="color: #800000;">'</span><span style="color: #800000;">HOST</span><span style="color: #800000;">'</span>: <span style="color: #800000;">'</span><span style="color: #800000;">127.0.0.1</span><span style="color: #800000;">'</span>,                     <span style="color: #008000;">#</span><span style="color: #008000;"> ip地址</span>
        <span style="color: #800000;">'</span><span style="color: #800000;">PORT</span><span style="color: #800000;">'</span>:3306,                            <span style="color: #008000;">#</span><span style="color: #008000;"> 端口</span>
        <span style="color: #800000;">'</span><span style="color: #800000;">USER</span><span style="color: #800000;">'</span>:<span style="color: #800000;">'</span><span style="color: #800000;">root</span><span style="color: #800000;">'</span>,                          <span style="color: #008000;">#</span><span style="color: #008000;"> 用户</span>
        <span style="color: #800000;">'</span><span style="color: #800000;">PASSWORD</span><span style="color: #800000;">'</span>:<span style="color: #800000;">'</span><span style="color: #800000;">123</span><span style="color: #800000;">'</span>                        <span style="color: #008000;">#</span><span style="color: #008000;"> 密码</span>
<span style="color: #000000;">    }
}</span></pre>
</div>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">在与settings,py同级目录下的init文件中写入：</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">import</span><span style="color: #000000;"> pymysql
pymysql.install_as_MySQLdb()</span></pre>
</div>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">创建表（在app下的models.py中写类）：</span></p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">from</span> django.db <span style="color: #0000ff;">import</span><span style="color: #000000;"> models
​
</span><span style="color: #0000ff;">class</span><span style="color: #000000;"> User(models.Model):
    username </span>= models.CharField(max_length=32)       <span style="color: #008000;">#</span><span style="color: #008000;"> username varchar(32)</span>
    password = models.CharField(max_length=32)       <span style="color: #008000;">#</span><span style="color: #008000;"> username varchar(32)</span></pre>
</div>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">执行数据库迁移的命令：</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">python manage.py makemigrations：检测每个注册app下的model.py，记录model的变更记录</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">python manage.py migrate：同步变更记录到数据库中</span></p>
</li>
</ul>
</li>
</ul>
<h3 class="md-end-block md-heading"><em><strong><span class="md-plain">六、MVC和MTV</span></strong></em></h3>
<ul>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">MVC </span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">M: model 模型 &mdash;&mdash; 和数据库打交道</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">V：view 视图 &mdash;&mdash; HTML </span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">C: controller 控制器 &mdash;&mdash; 调度 传递指令 业务逻辑</span></p>
</li>
</ul>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">MTV：</span></p>
<ul class="ul-list" data-mark="-">
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">M： model 模型 ORM &mdash;&mdash; 和数据库打交道</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">T: tempalte 模板 &mdash;&mdash; HTML</span></p>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">V：view 视图 &mdash;&mdash; 函数 业务逻辑</span></p>
</li>
</ul>
</li>
<li class="md-list-item">
<p class="md-end-block md-p"><span class="md-plain">djando是MTV模式</span></p>
</li>
</ul>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>